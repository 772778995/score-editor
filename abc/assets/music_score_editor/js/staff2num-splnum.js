/* staff2num-splnum */
var _$_20d6 = ["meter", "", "C,,", "D,,", "E,,", "F,,", "G,,", "A,,", "B,,", "C,", "D,", "E,", "F,", "G,", "A,", "B,", "C", "D", "E", "F", "G", "A", "B", "c", "d", "e", "f", "g", "a", "b", "c\'", "d\'", "e\'", "f\'", "g\'", "a\'", "b\'", "c\'\'", "d\'\'", "e\'\'", "f\'\'", "g\'\'", "a\'\'", "b\'\'", "C#", "F#", "Ab", "Bb", "Cb", "Db", "Eb", "Gb", "b,", "^f", "^c", "_b,", "_e", "_a,", "_d", "_g", "_c", "_b", "_a", "assign", "active", "removeClass", "siblings", "addClass", "replace", "toLowerCase", "\'", "replaceAll", "toUpperCase", ",", "0", "test", "1", "2", "3", "4", "5", "6", "7", "toString", "CDEFGAB", "match", "l", "length", "h", "top", "C|", "bot", "p", "clef_type", "nflags", "abs", "ctype", "grace", "dots", "istart", "iend", "substring", "indexOf", "a_meter", "p_v", "abcString", "voicetb", "curS", "splnum", "curPos", "sw", "type", "stop", "prev", "x", "wl", "tailPos", "sh", "chord", "notes", "next", "chordindex", "drawLine", "equalbars", "cfmt", "ts_next", "bar", "rest", "z", "drawDot2", "bar_type", "splx", "drawNote", "drawPlaceholder", "pit", "isTil", "drawRect", "right", "simpleNum", "drawGraceTail", "highpos", "lowpos", "dur", "my_line", "<circle cx=\"", "\" ", "out_svg", "class=\"splnum up\" cy=\"", "\"", "class=\"splnum bottom\" cy=\"", " r=\"", "\" stroke=\"black\" stroke-width=\"", "\"/>", "abcString is null", "log", ":.*(?=\\n)", "%%splnumscore.*(?=\\n)", "find", " ", "split", "%%transposes*.*(?=\\n)", "getCurS", "key", "k_sf", "value", "slice", "K", "bass,treble,alto,tenor", "shift=", "ymn", "0,0", "sort", "undefined", "st", "line", "vMax", "vMin", "filter", "concat", "|", "||", "drawBar", "ts_prev", "|]", "<use transform=\"translate(0,", ")\"  x=\"", "\"  y=\"", "\" xlink:href=\"#rdots\"></use>", "|:", "[|:", ":||:", "::", ":][:", "toFixed", "/", "fname", "error", "sy", "sx", "L", "M:", "M", "8", "16", "32", "64", "(", ")", "val", "#source", "octave", "=", ",,,,,,,,,", "\'\'\'\'\'\'\'\'\'", "X", "a_stk", "t", "{", "}", "isExtendChar", "show_char", "getExtendObject", "140,141", "instr", "prototype", " cy=\"", "\" r=\".7\" stroke=\"black\" stroke-width=\"1\"/>", "acc1", "&#x1d12a;", "^^", "\u266f", "^", "acc3", "\u266e", "acc-1", "\u266d", "_", "&#x1d12b;", "<text type=\"", "\" text-anchor=\"middle\" style=\"font-size: ", "20px", "12px", "\" x=\"", "y=\"", "\" height=\"24\">", "</text>", "a_gch", "text", "color:red;", "selected_text", "<text type=\"note\" istart=\"", "\" class=\"", " splnum f1 splfont ", "style=\"", "font-size:16px;", "font-size:", "px;", "\" height=\"24\" update_index=\"", "\">", "showmeterinstaff", "tgls", "<g type=\"meter\" class=\"spl_meter\"", "transform=\"translate(", ") ", "scale(", "text-anchor=\"middle\">", "<text type=\"meter\" y=\"-17\">", "<path type=\"meter\" class=\"stroke\" stroke-width=\"1.2\" d=\"m-6,-8h12z\"/>", "<text type=\"meter\" x=\"-0\">", "wr", "</g>", "<rect type=\"splplaceholder\" x=\"", "\" width=\"", "\" height=\"", "\" fill=\"block\"/>", "\u627e\u4e0d\u5230\u7b80\u8c31\u7684\u8c03\u53f7$1", "\u8f6c", "setStrwh", "<g type=\"key\" class=\"spl_meter_mode\" style=\"font-family:serif; font-weight:bold; font-size:15px\" ", " scale(", "<text type=\"key\" >", "1</text>", "<text type=\"key\" x=\"", "\">=</text>", "drawSharpSign", "\" text-anchor=\"start\">", "ckey", "<line x1=\"", "\" y1=\"", "\" x2=\"", "\" y2=\"", "\" class=\"splnum stroke\" stroke-width=\"1\" fill=\"black\"/>", "<g transform=\"translate(", ")\">", "<path class=\"splnum stroke b-grace\" stroke-width=\"1\" stroke-linecap=\"round\" stroke=\"black\" ", "d=\"m1,1 c", " 1,", "<path class=\"splnum stroke\" transform=\"translate(0,", ")\" stroke-width=\"", " d=\"m", "v-", "<path type=\"bracket\"  transform=\"translate(0,", ")\" class=\"fill\"\x0A\x09d=\"m", "\x0A\x09c10.5 1 12 -4.5 12 -3.5c0 1 -3.5 5.5 -8.5 5.5\x0A\x09v", "\x0A\x09c5 0 8.5 4.5 8.5 5.5c0 1 -1.5 -4.5 -12 -3.5\"/>\x0A", "splnum_bar", " onclick=\'clickBar(", ",event)\'", "<rect ", "  ondblclick = \"editorAnnot(", ")\" type=\"splnum_", " ph", "\" st=\"", "\" v=\"", "\" istart=\"", "\" class=\"abcr _", "10", " rt_", "_ rt_", " data-index=\"", " data-origindex=\"", "\" data-chordindex=\"", "\" y=\"", " onclick=\"window.open(\'", "\')\"", " style=\"cursor: pointer;\"", " width=\"", "\"/>\x0A", "v", "clone", "a_dd", "glyph", "calDecoPos", "push", "y", "dd_en", "dd_st", "dnb", "upb", "marcato", "wedge", "accent", "stc", "tenutoup", "opend", "dplus", "snap", "trl", "umrd", "lmrd", "roll", "turn", "invertedturn", "name", "dot", "func", "f,p", "turnx,sphr,turn", "coda", "dacs", "l_brackets,r_brackets_l,r_brackets_r", "l_brackets", "r_brackets_l", "r_brackets_r", ":", "brth", "pf", "sld", "sld_spl", "sldlu", "sldlu_spl", "sldrd", "sldrd_spl", "sldru", "sldru_spl", "strong,sec_strong,weak", "arp", "dur_orig", "wmeasure", "emb", "do,re,mi,fa,sol,la,si", "strong", "weak", "sec_strong", "f,ff,fff,ffff,fp,pf,p,pp,ppp,pppp", "anchor", "decoPos", "a_dcn", "~(", "atan2", "PI", "cos", "xmx", ") rotate(", "<use x=\"", "\" xlink:href=\"#ltr\"/>\x0A", "trem1", "\" xlink:href=\"#zy", "ntrem", "splnum_trans_key", "reverse", "annotation", "set_font", "\u6ce8", "slur_start", "slur_end", "ti1", "tie_s", "sls", "sl1", "tp", "dim", "fermatatime:", "jptext:", "tpheight:", "barwidth:", "{x:", "fng:", "rgb", "repeat", "\u30b5", "<", ">", " splfont ", "-mb-", "midi", "x-in:", "{\'gchtype\':", "-bk-", "-v-", "sh:", "(slur-", ")slur-", "<text x=\"", "\" class=\"fng\">", "</text>\x0A", "@", "[font-size", "exec", " onmousemove=\'moveSvgText(event)\' onmousedown=\'mousedownSvgText(event)\' onmouseup=\'mouseupSvgText(event)\' onmouseout=\'mouseoutSvgText(event)\'", " gch_istart=\"", "\" gch_iend=\"", "<text ondblclick=\"editorAnnot(", ")\" istart=\"", "\" type=\"zs\"", " xml:space=\"preserve\" style=\"", "fid", "font", "bar_num", "measure", "curfont", "gene", "font_class", "get_deco_str_style", "str", "def", "\x0A.", " {", "style", "add_style", "middle", "\" cat=\"decos\" istart=\"", "\" type=\"", "get_glyphs", "scale", "stv_g", "sc", "<text cat=\"decos\" type=\"", "\" transform=\"translate(", ") scale(", "\" cat=\"decos\" type=\"", "path", "def_use", "img", "pos", "http", "\" xlink:href=\"#", "<defs><path id=\"ltr\" class=\"fill\"\x0A\x09d=\"m0 -.4c2 -1.5 3.4 -1.9 3.9 .4 0.2 .8 .7 .7 2.1 -.4\x0A\x09v0.8c-2 1.5 -3.4 1.9 -3.9 -.4 -.2 -.8 -.7 -.7 -2.1 .4z\"/></defs>", "<g class=\"arp_spl\" transform=\"translate(", ") rotate(270", ")\">\x0A", "ceil", "\" d y=\"", "\" xlink:href=\"#ltr\"></use>", "</g>\x0A", "ctype1", "beatTime", "currMeter", "ulen", "minBeatTime", "1/", "isComplex", "currComplexArr", "complexForm", "computBeatTime2point", "currComplexArrPoint", "gr_end", "setBeatTime", "clean", "lastNoteDot", "8,10", "beatTimeCount", "lastNoteNflags", "pow", "dot_low", "notePic", "a_pic", "is_bar_pic", "get_svg", "_x", "_w", "set_svg", "t_gr_arr", "(<text .*", "_grace\".*>)(.*)(</text>)", "get_staff_tb", "get_voice_tb", "source", "getElementById", "init", "setCurS", "time", "refreshBeat", "tempo", "[", "%%text", "isRhythmStaff", "hiddenkey", "drawSplMode", "hiddenmeter", "drawSplMeter", "topbar", "staffscale", "multi", "dot_low_prev_note", "crdHei", "addHei", "note,grace,rest", "spl", "\\[,\\]", "dot_low_note", "splice", "s", "note", "chordLink", "<g type=\"bar_datas\" st=\"", " isgrace=\"1\" ", "curnote", "noteHeight", "slur2s", "slur2sh", "slur_type", "x_border", "0,2,3,4,5,6", "drawDot", "note,grace,chord", "drawDeco", "drawGch", "index", "measurenb 1", "clef", "drawBarnum", "\\[", "x_meter", "stringify", "parse", "m", " q", " t", "<path istart=\"", "\" stroke-width=\"0.2\" stroke=\"black\" fill=\"black\" fill-rule=\"evenodd\" cat=\"decos\" start=\"\" end=\"\" type=\"slur\" class=\"fill\" d=\"", "\"></path>", "\" stroke-width=\"0.2\" stroke=\"black\" cat=\"decos\" start=\"", "\" end=\"", "\" type=\"slur\" class=\"fill\" d=\"M", "\" type=\"slur\" class=\"stroke\" stroke-dasharray=\"5,5\" d=\"M", "\x0A\x09v", "cresc", "sIstart", "eIstart"];
var musicType = 0;
var isFixedMode = 0;
var splMarginTop = 10;
var spllineMarginTop = 40;
var underlineSpace = 3;
var underlineMarginBottom = -8;
var underlineLen = 11;
var circleMarginTop = -9;
var circleMarginBottom = 3;
var circleSpace = 3.5;
var circleR = 0.7;
var circleW = 1;
var graceScale = 0.66;
var graceLen = 8;
var firstGraceX = 0;
var tempoMgL = 45;
var tempoMgB = 10;
var lySpace = 10;
var chordScale = 1;
var chordSpace = 6;
var chordFontSize = 18;
var METER = "meter";
var dotMarginRight = 2;
var radianHei = 6;
var lastBarNumMap = {};
var transYOffset = 0;
var splBarHeight = 0;
var currKey = "";
var transY_tmp = 0;
var bar_height = 28.6;
var isExistDimByLine = false;
var isSameByline = 0;
var notesArr = ["C,,", "D,,", "E,,", "F,,", "G,,", "A,,", "B,,", "C,", "D,", "E,", "F,", "G,", "A,", "B,", "C", "D", "E", "F", "G", "A", "B", "c", "d", "e", "f", "g", "a", "b", "c\'", "d\'", "e\'", "f\'", "g\'", "a\'", "b\'", "c\'\'", "d\'\'", "e\'\'", "f\'\'", "g\'\'", "a\'\'", "b\'\'"];
var toneMarkMap = {
    "^c": "C#",
    "^f": "F#",
    "a": "A",
    "b,": "B",
    "c": "C",
    "d": "D",
    "e": "E",
    "f": "F",
    "g": "G",
    "_a,": "Ab",
    "_b,": "Bb",
    "_c": "Cb",
    "_d": "Db",
    "_e": "Eb",
    "_g": "Gb"
};
var tmVal2key = {};

function setValue2key() {
    for (var _0xB204 in toneMarkMap) {
        tmVal2key[toneMarkMap[_0xB204]] = _0xB204
    };
    Object["assign"](tmVal2key, {
        'CMAJOR': "c",
        'Cmaj': "c",
        'C major': "c",
        'C Major': "c",
        'C Ionian': "c",
        'Am': "c",
        'C Lydian': "g",
        'Em': "g",
        'GMAJOR': "g",
        'Gmajor': "g",
        'Gmaj': "g",
        'G major': "g",
        'G Major': "g",
        'G Ionian': "g",
        'Bm': "d",
        'DMAJOR': "d",
        'Dmajor': "d",
        'Dmaj': "d",
        'D major': "d",
        'D Major': "d",
        'D Ionian': "d",
        'F#m': "a",
        'AMAJOR': "a",
        'Amajor': "a",
        'Amaj': "a",
        'A major': "a",
        'A Major': "a",
        'A Ionian': "a",
        'C#m': "e",
        'EMAJOR': "e",
        'Emajor': "e",
        'Emaj': "e",
        'E major': "e",
        'E Major': "e",
        'E Ionian': "e",
        'G#m': "b,",
        'BMAJOR': "b,",
        'Bmajor': "b,",
        'Bmaj': "b,",
        'B major': "b,",
        'B Major': "b,",
        'B Ionian': "b,",
        'D#m': "^f",
        'F#MAJOR': "^f",
        'F#major': "^f",
        'F#maj': "^f",
        'F# major': "^f",
        'F# Major': "^f",
        'F# Ionian': "^f",
        'A#m': "^c",
        'C#MAJOR': "^c",
        'C#major': "^c",
        'C#maj': "^c",
        'C# major': "^c",
        'C# Major': "^c",
        'C# Ionian': "^c",
        'C Mixolydian': "f",
        'Dm': "f",
        'FMAJOR': "f",
        'Fmajor': "f",
        'Fmaj': "f",
        'F major': "f",
        'F Major': "f",
        'F Ionian': "f",
        'Gm': "_b,",
        'BbMAJOR': "_b,",
        'Bbmajor': "_b,",
        'Bbmaj': "_b,",
        'Bb major': "_b,",
        'Bb Major': "_b,",
        'Bb Ionian': "_b,",
        'Cm': "_e",
        'EbMAJOR': "_e",
        'Ebmajor': "_e",
        'Ebmaj': "_e",
        'Eb major': "_e",
        'Eb Major': "_e",
        'Eb Ionian': "_e",
        'Fm': "_a,",
        'AbMAJOR': "_a,",
        'Abmajor': "_a,",
        'Abmaj': "_a,",
        'Ab major': "_a,",
        'Ab Major': "_a,",
        'Ab Ionian': "_a,",
        'Bbm': "_d",
        'DbMAJOR': "_d",
        'Dbmajor': "_d",
        'Dbmaj': "_d",
        'Db major': "_d",
        'Db Major': "_d",
        'Db Ionian': "_d",
        'Ebm': "_g",
        'GbMAJOR': "_g",
        'Gbmajor': "_g",
        'Gbmaj': "_g",
        'Gb major': "_g",
        'Gb Major': "_g",
        'Gb Ionian': "_g",
        'Abm': "_c",
        'CbMAJOR': "_c",
        'Cbmajor': "_c",
        'Cbmaj': "_c",
        'Cb major': "_c",
        'Cb Major': "_c",
        'Cb Ionian': "_c",
        'C Dorian': "_b",
        'C Minor': "_e",
        'Cm': "_e",
        'C Aeolian': "_e",
        'C Phrygian': "_a",
        'C Locrian': "_d"
    })
}
setValue2key();
var beatArr = [
    [6, [
        [0, 0, 0],
        [0, 0, 0]
    ]],
    [5, [
        [0, 0],
        [0, 0, 0]
    ]],
    [4, [
        [0, 0],
        [0, 0]
    ]],
    [3, [
        [0, 0, 0]
    ]],
    [2, [
        [0, 0]
    ]],
    [1, [
        [0]
    ]]
];

function toggleStaff(_0x9333, _0xCB17) {
    musicType = _0xCB17;
    src_change();
    $(_0x9333)["addClass"]("active")["siblings"]()["removeClass"]("active")
}

function note2number(_0x6FFB) {
    _0x6FFB = _0x6FFB["replace"](/\d*/g, "");
    _0x6FFB = _0x6FFB["replace"](/([A-Z])\'/g, function($1) {
        if ($1) {
            return $1["replaceAll"]("\'", "")["toLowerCase"]()
        }
    });
    _0x6FFB = _0x6FFB["replace"](/([a-z]),/g, function($1) {
        if ($1) {
            return $1["replaceAll"](",", "")["toUpperCase"]()
        }
    });
    return _0x6FFB["replace"](/[a-zA-Z]/g, function(_0x862F) {
        var _0xB69C = "0";
        if (/z/ ["test"](_0x862F)) {
            return _0xB69C
        };
        if (/[cC]/ ["test"](_0x862F)) {
            _0xB69C = "1"
        } else {
            if (/[dD]/ ["test"](_0x862F)) {
                _0xB69C = "2"
            } else {
                if (/[eE]/ ["test"](_0x862F)) {
                    _0xB69C = "3"
                } else {
                    if (/[fF]/ ["test"](_0x862F)) {
                        _0xB69C = "4"
                    } else {
                        if (/[gG]/ ["test"](_0x862F)) {
                            _0xB69C = "5"
                        } else {
                            if (/[aA]/ ["test"](_0x862F)) {
                                _0xB69C = "6"
                            } else {
                                if (/[bB]/ ["test"](_0x862F)) {
                                    _0xB69C = "7"
                                }
                            }
                        }
                    }
                }
            }
        };
        if (_0xB69C) {
            return _0xB69C["toString"]() + "" + (/[a-z]/ ["test"](_0x862F) ? "\'" : "")
        }
    })
}
var baseNote = "CDEFGAB";

function getNote(_0x6FFB) {
    return _0x6FFB["match"](/[\_\^\=]*[a-zA-Z][\'\,]*/)[0]
}

function getNumber(_0xAF56) {
    if (!_0xAF56) {
        return
    };
    if (/[\u4e00-\u9fa5]/ ["test"](_0xAF56)) {
        return _0xAF56
    };
    return _0xAF56["match"](/[\u4e00-\u9fa5X0-9a-zA-Z]/)[0]
}

function getPitchSym(_0x6FFB) {
    var _0xAF87 = _0x6FFB["match"](/,+/);
    if (_0xAF87) {
        return ["l", _0xAF87 ? _0xAF87[0]["length"] : 0]
    };
    var _0xAFB8 = _0x6FFB["match"](/\'+/);
    if (_0xAFB8) {
        return ["h", _0xAFB8 ? _0xAFB8[0]["length"] : 0]
    };
    return 0
}

function getMeter(_0x71B4) {
    if (!(_0x71B4 && _0x71B4["top"])) {
        return null
    };
    if ("C|" == _0x71B4["top"]) {
        _0x71B4["top"] = _0x71B4["bot"] = "2"
    } else {
        if ("C" == _0x71B4["top"]) {
            _0x71B4["top"] = _0x71B4["bot"] = "4"
        }
    };
    if (!_0x71B4["bot"]) {
        return null
    };
    return _0x71B4
}

function isRhythm(_0x7DF4) {
    return "p" == _0x7DF4["clef_type"]
}

function getNoteLen(_0xADCE, _0x7DF4) {
    var _0xAE30 = "h";
    var _0xADFF = Math["abs"](_0x7DF4["nflags"]);
    var _0x957F = 0;
    if (_0x7DF4["ctype"] == "grace" && isShortGlide(_0xADCE, _0x7DF4)) {
        _0x7DF4["nflags"] += 1
    };
    if (_0x7DF4["nflags"] > 0) {
        _0xAE30 = "b";
        _0xADFF = _0x7DF4["nflags"];
        _0x957F = _0x7DF4["dots"]
    };
    var _0x8509 = _0xADCE["substring"](_0x7DF4["istart"], _0x7DF4["iend"]);
    if (_0x8509["indexOf"]("h") > -1) {
        var _0x71B4 = getMeter(_0x7DF4["p_v"]["meter"]["a_meter"][0]);
        if (!_0x71B4) {
            return
        };
        var _0xAD9D = _0x71B4["top"];
        var _0xAD6C = _0x71B4["bot"];
        if (_0x7DF4["nflags"] == -2) {
            return [_0xAE30, _0x71B4["top"] - 1, _0x957F]
        }
    };
    if (_0x7DF4["nflags"] == -2) {
        var _0x71B4 = getMeter(_0x7DF4["p_v"]["meter"]["a_meter"][0]);
        if (!_0x71B4) {
            return
        };
        var _0xAD9D = _0x71B4["top"];
        var _0xAD6C = _0x71B4["bot"];
        if (_0xAD6C < 4) {
            _0xAD9D = 4 / _0xAD6C * _0xAD9D;
            _0xAD6C = 4 / _0xAD6C * _0xAD6C
        };
        _0xADFF = Number(_0xAD6C) - 1
    };
    return [_0xAE30, _0xADFF, _0x957F]
}

function getNoteLenUg(_0xADCE, _0x7DF4) {
    var _0xAE30 = "h",
        _0x957F = 0;
    if (_0x7DF4["nflags"] > 0) {
        _0xAE30 = "b"
    };
    var _0xADFF = Math["abs"](_0x7DF4["nflags"]);
    switch (_0x7DF4["nflags"]) {
        case -1:
            _0xADFF = 1;
            if (_0x7DF4["dots"] > 0) {
                _0xADFF = _0xADFF + 1;
                _0x957F = _0x7DF4["dots"] - 1
            };
            break;
        case -2:
            _0xADFF = 3;
            if (_0x7DF4["dots"] > 0) {
                _0xADFF = _0xADFF + 2;
                _0x957F = _0x7DF4["dots"] - 1;
                if (_0x957F > 0) {
                    _0xADFF = _0xADFF + 1;
                    _0x957F = _0x957F - 1
                }
            };
            break;
        default:
            break
    };
    return [_0xAE30, _0xADFF, _0x957F]
}

function getNoteStartX(_0x6F06, _0xAE92) {
    return splSx(_0x6F06) + Number(_0xAE92 || 2)
}
var graceFirstIndex = 0;

function drawNoteLen(_0x862F) {
    var _0x7DC3 = _0x862F["abcString"];
    var _0x98C0 = _0x862F["voicetb"];
    var _0x7DF4 = _0x862F["curS"];
    var _0x792B = _0x862F["splnum"];
    var _0x9738 = _0x792B["curPos"];
    var _0x6ED5 = _0x792B["sw"][0],
        _0x6CEB = _0x792B["sw"][1],
        _0x6E73 = _0x792B["type"],
        _0x6DE0 = _0x792B["stop"];
    var _0x979A = getNoteLenUg(_0x7DC3, _0x7DF4);
    if (!_0x979A) {
        return
    };
    if (eq("grace", _0x792B["type"]) && graceFirstIndex == 0 && (!_0x7DF4["prev"] || !_0x7DF4["prev"]["grace"])) {
        firstGraceX = getNoteStartX(_0x792B["x"], _0x7DF4["wl"]);
        graceFirstIndex++
    };
    var _0x9707 = _0x979A[0];
    var _0x96D6 = _0x979A[1];
    var _0x957F = _0x979A[2];
    var _0x951D = null;
    _0x951D = checkBeam(_0x792B["type"], _0x7DC3, _0x7DF4);
    var _0x9769 = _0x951D[0] ? (_0x951D[1] ? _0x951D[1]["nflags"] : 0) : 0;
    if (eq("grace", _0x792B["type"]) && isShortGlide(_0x7DC3, _0x7DF4)) {
        if (_0x951D[0]) {
            _0x9769 += 1
        };
        _0x96D6 = _0x7DF4["nflags"] + 1
    };
    var _0x954E = getNoteStartX(_0x792B["x"], _0x7DF4["wl"]);
    var _0x8509 = _0x7DC3["substring"](_0x7DF4["istart"], _0x7DF4["iend"]);
    if ("b" == _0x9707) {
        _0x792B["tailPos"] = abc["sh"](_0x6CEB);
        for (var _0x6D1C = 0; _0x6D1C < _0x96D6; _0x6D1C++) {
            _0x792B["tailPos"] += underlineSpace;
            var _0x988F = -2 + _0x954E;
            if (3251 == _0x7DF4["istart"]) {};
            if (_0x951D[0] && _0x6D1C < _0x9769 && (!eq("chord", _0x792B["type"]) || (eq("chord", _0x792B["type"]) && _0x7DF4["next"]["notes"] && (!(isVoiceMerge && _0x7DF4["next"]["type"] == 10)) && (_0x7DF4["next"]["notes"]["length"] > _0x862F["chordindex"])))) {
                drawIns["drawLine"](translateValue(_0x6E73, _0x988F), _0x792B["curPos"] + _0x792B["tailPos"], translateValue(_0x6E73, _0x951D[1]["x"] - _0x792B["x"] - Number(_0x7DF4["wl"] || 2) - 2))
            } else {
                drawIns["drawLine"](translateValue(_0x6E73, _0x988F), _0x792B["curPos"] + _0x792B["tailPos"], underlineLen)
            }
        }
    } else {
        var _0x733C = 4;
        var _0x98F1 = _0x96D6;
        var _0x982D = _0x792B["curPos"] + Number(_0x6CEB);
        if (_0x7DF4["next"] && _0x7DF4["next"]["x"]) {
            _0x733C = ((splSx(_0x7DF4["next"]["x"]) - splSx(_0x7DF4["x"]) - abc["sh"](_0x6ED5)) - (_0x96D6) * abc["sh"](_0x6ED5)) / (_0x96D6 + 1);
            if (_0x7DF4["next"]["type"] == "4" && abc["cfmt"]()["equalbars"]) {
                _0x733C = ((splSx(_0x7DF4["next"]["ts_next"]["x"]) - splSx(_0x7DF4["x"]) - abc["sh"](_0x6ED5)) - (_0x96D6) * abc["sh"](_0x6ED5)) / (_0x96D6 + 1)
            }
        } else {
            for (var _0x7867 = _0x7DF4["ts_next"]; _0x7867; _0x7867 = _0x7867["ts_next"]) {
                if (_0x7867["ctype"] == "bar") {
                    _0x733C = ((splSx(_0x7867["x"]) - abc["sh"](_0x6ED5) - splSx(_0x7DF4["x"])) - (_0x96D6) * abc["sh"](_0x6ED5)) / (_0x96D6 + 1);
                    break
                }
            }
        };
        if (eq("rest", _0x792B["type"]) && _0x7DF4["nflags"] == -2 && _0x8509["indexOf"]("z") > -1) {
            var _0x97FC = fullRest(_0x7DC3, _0x98C0["meter"]["a_meter"][0], _0x7DF4, _0x792B["type"], _0x792B["sw"], _0x982D);
            drawIns["drawDot2"](_0x97FC, _0x792B["curPos"] + Number(_0x6CEB), _0x957F, _0x6ED5, 0)
        } else {
            if (_0x7DF4["next"] && /:/ ["test"](_0x7DF4["next"]["bar_type"])) {
                _0x733C -= Number(4 + 2 + 2) / (_0x96D6 + 1)
            };
            var _0x81C8 = 0;
            for (var _0x6D1C = 0; _0x6D1C < _0x98F1; _0x6D1C++) {
                var _0x97CB = (_0x792B["splx"] || getNoteStartX(_0x792B["x"], _0x7DF4["wl"])) + _0x733C * (_0x6D1C + 1) + abc["sh"](_0x6ED5) * (_0x6D1C + 1);
                if (eq("rest", _0x792B["type"]) && _0x8509["indexOf"]("z") > -1) {
                    drawIns["drawNote"]("0", _0x97CB, _0x982D, null, _0x6D1C)
                } else {
                    drawIns["drawPlaceholder"](_0x97CB, _0x792B["curPos"] + abc["sh"](_0x6CEB) / 2);
                    drawIns["drawRect"](_0x97CB - 2, _0x792B["curPos"], 6 + 4, Number(_0x6CEB) + 4, lastTil["pit"] == _0x7DF4["notes"][0]["pit"] && lastTil["isTil"] ? lastTil["istart"] : _0x7DF4["istart"], _0x6D1C + 1, _0x862F["chordindex"], null, true)
                };
                if (_0x6D1C == _0x98F1 - 1) {
                    _0x81C8 = _0x97CB
                }
            };
            drawIns["drawDot2"](_0x81C8, _0x792B["curPos"] + Number(_0x6CEB), _0x957F, _0x6ED5)
        }
    };
    if (eq("grace", _0x792B["type"]) && (!_0x7DF4["next"] || !_0x7DF4["next"]["grace"])) {
        var _0x96A5 = _0x954E;
        var _0x9612 = firstGraceX ? (_0x954E - firstGraceX) / 2 : graceLen;
        if (firstGraceX) {
            _0x96A5 = _0x954E - _0x9612
        };
        var _0x95E1 = checkGracePos(_0x7DF4) == "right" ? "b" : "f";
        var _0x9643 = translateValue(_0x6E73, _0x96A5);
        var _0x9674 = _0x792B["curPos"] + (_0x792B["tailPos"] ? _0x792B["tailPos"] : (Number(_0x6CEB) + circleW));
        var _0x985E = _0x792B["simpleNum"]["match"](/,+/g);
        if (_0x985E) {
            _0x9674 += (circleR + circleW) * 2;
            for (var _0x6D1C = 0; _0x6D1C < _0x985E[0]["length"]; _0x6D1C++) {
                _0x9674 += circleSpace
            }
        };
        var _0x95B0 = (firstGraceX ? _0x9612 + 10 : _0x9612);
        drawIns["drawGraceTail"](_0x95E1, _0x9643 + Number(_0x7DF4["wl"] || 2), _0x9674, _0x95B0);
        firstGraceX = 0;
        graceFirstIndex = 0
    }
}

function pitchPs(_0x74F5, _0xBCED, _0x6E73) {
    var _0x74F5 = getNumber(_0x74F5),
        _0x6F06 = 0;
    switch (Number(_0x74F5)) {
        case 1:
            if (_0xBCED) {
                _0x6F06 += 0.9
            };
            break;
        case 4:
            if (_0xBCED) {
                _0x6F06 += 1
            } else {
                _0x6F06 += 2.35;
                if (eq("grace", _0x6E73)) {
                    _0x6F06 = 1.5
                }
            };
            break;
        case 6:
            if (_0xBCED) {
                _0x6F06 += 0.6
            };
            break;
        case 7:
            break
    };
    return _0x6F06
}

function drawPitch(_0x792B, _0x6D7E) {
    var _0x6ED5 = _0x792B["sw"][0],
        _0x6CEB = _0x792B["sw"][1];
    var _0x9984 = getPitchSym(_0x792B["simpleNum"]);
    if (!_0x9984) {
        return
    };
    var _0x9922 = (circleR + circleW) * 2;
    if ("h" == _0x9984[0]) {
        _0x792B["highpos"] = _0x9922
    } else {
        _0x792B["lowpos"] = (_0x792B["tailPos"] ? _0x792B["tailPos"] : _0x6CEB) + _0x9922
    };
    var _0x8755 = getNoteStartX(_0x792B["x"], _0x6D7E["wl"]);
    if (_0x6D7E["dur"] && _0x6D7E["dur"] == 1536 && abc["cfmt"]()["equalbars"]) {
        _0x8755 = _0x8755 + 2;
        if (_0x6D7E["my_line"] != 0 && _0x6D7E["x"] < 60) {
            _0x8755 = _0x8755 + 4
        }
    };
    var _0x9953 = _0x8755 + (Number(_0x6ED5) - _0x9922) / 2 + pitchPs(_0x792B["simpleNum"], "h" != _0x9984[0], _0x792B["type"]);
    if (eq("grace", _0x792B["type"])) {
        _0x9953 = (_0x9953 - 1.5) / graceScale
    };
    for (var _0x77A3 = 0; _0x77A3 < _0x9984[1]; _0x77A3++) {
        abc["out_svg"]("<circle cx=\"" + _0x9953 + "\" ");
        if ("h" == _0x9984[0]) {
            _0x792B["highpos"] -= abc["sh"](circleSpace);
            abc["out_svg"]("class=\"splnum up\" cy=\"" + (_0x792B["curPos"] + _0x792B["highpos"]) + "\"")
        } else {
            if (_0x77A3 > 0) {
                _0x792B["lowpos"] += abc["sh"](circleSpace)
            };
            abc["out_svg"]("class=\"splnum bottom\" cy=\"" + (_0x792B["curPos"] + _0x792B["lowpos"]) + "\"")
        };
        abc["out_svg"](" r=\"" + circleR + "\" stroke=\"black\" stroke-width=\"" + circleW + "\"/>")
    }
}

function translateValue(_0x6E73, _0xA12C) {
    if (_0x6E73 == "grace") {
        return _0xA12C / graceScale
    } else {
        if (_0x6E73 == "chord") {
            return _0xA12C / chordScale
        }
    };
    return _0xA12C
}

function getTag(_0x7DC3, _0xB1A2) {
    if (!_0x7DC3) {
        console["log"]("abcString is null");
        return
    };
    return _0x7DC3["match"](new RegExp(_0xB1A2 + ":.*(?=\\n)"))[0]
}

function getSplnumscore(_0x7DC3, _0x8786) {
    var _0x82BD = _0x7DC3["match"](new RegExp("%%splnumscore.*(?=\\n)"));
    if (!_0x82BD) {
        return true
    };
    var _0xB0AD = _0x82BD[0]["replace"](/%%splnumscore\s*/g, "");
    if (!_0xB0AD) {
        return true
    };
    return _0xB0AD["split"](" ")["find"](function(_0x6D1C) {
        return _0x6D1C - 1 == _0x8786
    })
}

function getToneMark(_0x7DC3, _0xB204, _0xB1D3) {
    if (!_0x7DC3) {
        console["log"]("abcString is null");
        return
    };
    var _0xB2C8 = _0x7DC3["match"](new RegExp("%%transposes*.*(?=\\n)"));
    if (_0xB2C8) {
        var _0x6D7E = abc["getCurS"]();
        if (_0x6D7E && _0x6D7E["p_v"] && _0x6D7E["p_v"]["key"]) {
            var _0xB204 = keyTransfer[_0x6D7E["p_v"]["key"]["k_sf"]];
            if (_0xB204) {
                return _0xB204["value"]
            }
        }
    };
    var _0x6C89 = _0xB204 ? _0x7DC3["slice"](_0xB204["istart"], _0xB204["iend"]) : getTag(_0x7DC3, "K");
    var _0xB297 = _0x6C89["match"](/K:\s*[a-zA-Z#]+\s*\w*/g);
    if (!_0xB297) {
        return null
    };
    _0xB297 = _0xB297[0];
    var _0xB266 = _0xB297["replace"](/K:\s*/g, "");
    if (eq("bass,treble,alto,tenor", _0xB266)) {
        _0xB266 = currKey
    };
    if (!tmVal2key[_0xB266]) {
        _0xB266 = _0xB266["split"](" ")[0]
    };
    if (_0xB1D3) {
        currKey = toneMarkMap[tmVal2key[_0xB266]];
        return toneMarkMap[tmVal2key[_0xB266]]
    };
    var _0xB235 = _0x6C89["match"](/shift=(\^*\w+,*)+/);
    if (_0xB235) {
        _0xB235 = _0xB235[0]["replace"]("shift=" + tmVal2key[_0xB266], "")["replace"](/\s*/, "");
        currKey = toneMarkMap[_0xB235] || "";
        return toneMarkMap[_0xB235] || ""
    };
    if (tmVal2key[_0xB266]) {
        currKey = toneMarkMap[tmVal2key[_0xB266]];
        return toneMarkMap[tmVal2key[_0xB266]]
    };
    currKey = _0xB266;
    return _0xB266
}

function rtnNoteY(_0x6DAF) {
    return getNoteY(_0x6DAF)["ymn"]
}

function getNoteY(_0x6DAF, _0x8786, _0x6B32) {
    var _0x9333 = {
        'key': "0,0",
        'ymn': 0,
        'y': 0,
        'ymx': 0,
        'st': 0,
        'line': 0,
        'crdHei': 0,
        'addHei': 0
    };
    if (!lineyArr || !lineyArr["length"]) {
        return _0x9333
    };
    lineyArr["sort"](function(_0xAEF4, _0xAF25) {
        return Number(_0xAEF4["key"]["replace"](",", "")) - Number(_0xAF25["key"]["replace"](",", ""))
    });
    var _0xAEC3 = lineyArr && lineyArr["find"](function(_0x89A1) {
        var _0x9302 = _0x89A1["key"]["split"](",");
        return _0x9302[0] <= _0x6DAF && _0x6DAF <= _0x9302[1] && (typeof _0x8786 == "undefined" ? true : _0x89A1["st"] == _0x8786) && (typeof _0x6B32 == "undefined" ? true : _0x89A1["line"] == _0x6B32)
    });
    if (_0xAEC3) {
        return _0xAEC3
    };
    return _0x9333
}

function getVoiceNumByCurrBar(_0x6DAF, _0x9E1C) {
    var _0xB32A, _0xB35B;
    barVoiceNumArr["sort"](function(_0xAEF4, _0xAF25) {
        _0xB32A = _0xAEF4["key"]["split"](",");
        _0xB35B = _0xAF25["key"]["split"](",");
        return (_0xB32A[1] - _0xB32A[0]) - (_0xB35B[1] - _0xB35B[0])
    });
    var _0x9302;
    var _0xB2F9 = []["concat"](barVoiceNumArr && barVoiceNumArr["filter"](function(_0x89A1) {
        _0x9302 = _0x89A1["key"]["split"](",");
        return _0x9302[0] <= _0x6DAF && _0x6DAF <= _0x9302[1] && _0x89A1["vMax"] >= _0x9E1C && _0x89A1["vMin"] <= _0x9E1C
    }));
    if (!(_0xB2F9 && _0xB2F9["length"])) {
        return -1
    };
    _0xB2F9["sort"](function(_0x7526, _0x8A03) {
        return _0x8A03["vMax"] - _0x7526["vMax"]
    });
    return _0xB2F9[0]
}

function drawAllBar(_0x6FFB, _0x7431, _0x831F, _0x8350, _0x6CEB, _0x6D7E) {
    var _0x948A = 0,
        _0x9428 = 24,
        _0x9459 = 0;
    if ("|" == _0x6FFB || ".|" == _0x6FFB ||  "||" == _0x6FFB || /\|\d/g ["test"](_0x6FFB)) {
        drawIns["drawBar"](_0x7431, _0x831F, _0x8350, 1.8, _0x6CEB, ".|" == _0x6FFB);
        if (singleline && bar_visible[_0x6D7E["st"]] == 1 && bar_visible[_0x6D7E["st"]] < max_st_nodenum) {
            var _0x94BB = _0x6D7E["ts_prev"];
            var _0x94EC = 0;
            while (_0x94BB) {
                if (_0x94BB["type"] == 0 && _0x94BB["x"] != _0x6D7E["x"]) {
                    _0x94EC = _0x94BB["x"];
                    break
                };
                _0x94BB = _0x94BB["ts_prev"]
            }
        };
        _0x948A = 5;
        _0x9459 = _0x831F
    };
    if ("||" == _0x6FFB) {
        drawIns["drawBar"](_0x7431, _0x831F + 3, _0x8350, 1.8, _0x6CEB);
        _0x948A = 1;
        _0x9459 = _0x831F
    };
    if ("|]" == _0x6FFB || /:\|]?\d?/ ["test"](_0x6FFB)) {
        drawIns["drawBar"](_0x7431, _0x831F, _0x8350, 1, _0x6CEB);
        drawIns["drawBar"](_0x7431, _0x831F + 4, _0x8350, 3, _0x6CEB);
        _0x948A = 3 + 1 + 3;
        _0x9459 = _0x831F
    };
    if (/:\|]?\d?/ ["test"](_0x6FFB)) {
        abc["out_svg"]("<use transform=\"translate(0," + _0x7431 + ")\"  x=\"" + (_0x831F - 4) + "\"  y=\"" + (_0x8350 + 24) + "\" xlink:href=\"#rdots\"></use>");
        _0x9459 = _0x831F - 4
    };
    if ("|:" == _0x6FFB || "[|:" == _0x6FFB) {
        drawIns["drawBar"](_0x7431, _0x831F, _0x8350, 1, _0x6CEB);
        drawIns["drawBar"](_0x7431, _0x831F - 4, _0x8350, 3, _0x6CEB);
        abc["out_svg"]("<use transform=\"translate(0," + _0x7431 + ")\"  x=\"" + (_0x831F + 4) + "\"  y=\"" + (_0x8350 + 24) + "\" xlink:href=\"#rdots\"></use>");
        _0x948A = 4 + 1 + 3;
        _0x9459 = _0x831F - 4
    };
    if (":||:" == _0x6FFB || "::" == _0x6FFB || ":][:" == _0x6FFB) {
        abc["out_svg"]("<use transform=\"translate(0," + _0x7431 + ")\"  x=\"" + (_0x831F - 4) + "\"  y=\"" + (_0x8350 + 24) + "\" xlink:href=\"#rdots\"></use>");
        drawIns["drawBar"](_0x7431, _0x831F, _0x8350, 3, _0x6CEB);
        drawIns["drawBar"](_0x7431, _0x831F + 5, _0x8350, 3, _0x6CEB);
        abc["out_svg"]("<use transform=\"translate(0," + _0x7431 + ")\"  x=\"" + (_0x831F + 9) + "\"  y=\"" + (_0x8350 + 24) + "\" xlink:href=\"#rdots\"></use>");
        _0x948A = 1 + 3 + 3 + 1;
        _0x9459 = _0x831F - 4
    };
    drawIns["drawRect"](_0x9459["toFixed"](2) - 6, _0x7431 + _0x8350 - (bar_height - 24) * 0.5, _0x948A + 10, bar_height, -1)
}

function isShortGlide(_0x7DC3, _0x6D7E) {
    var _0xB5A7 = _0x6D7E,
        _0x75EA = null;
    for (; _0xB5A7; _0xB5A7 = _0xB5A7["prev"]) {
        _0x75EA = _0xB5A7
    };
    var _0x6C27 = _0x7DC3["slice"](_0x75EA["istart"] - 1, _0x75EA["istart"]);
    if ("/" == _0x6C27) {
        return true
    };
    return false
}

function splerror(_0x6B63, _0xC95E) {
    var _0x6D7E = abc["getCurS"]();
    abc["error"](1, {
        fname: _0x6D7E["fname"],
        istart: _0x6D7E["istart"]
    }, _0x6B63, _0xC95E)
}

function splSy(_0x6F37) {
    return Number(abc["sy"](_0x6F37)["toFixed"](2))
}

function splSx(_0x6F06) {
    return Number(abc["sx"](_0x6F06)["toFixed"](2))
}

function fullRest(_0x7DC3, _0x71B4, _0x7DF4, _0x6E73, _0x6E11, _0x982D) {
    var _0xA657 = 0,
        _0x7805 = 0;
    var _0x6C58 = getTag(_0x7DC3, "L");
    var _0x6ED5 = _0x6E11[0],
        _0x6CEB = _0x6E11[1];
    if (!_0x71B4) {
        var _0xA74C = getTag(_0x7DC3, "M")["replace"]("M:", "")["replaceAll"](" ", "");
        _0x71B4 = new Object();
        _0x71B4["top"] = _0xA74C["split"]("/")[0];
        _0x71B4["bot"] = _0xA74C["split"]("/")[1]
    };
    if (_0x71B4["bot"] == 2) {
        _0x71B4["bot"] = 4;
        _0x71B4["top"] = _0x71B4["top"] * 2
    };
    _0xA657 = Number(_0x71B4["top"]);
    _0x7805 = _0x71B4["bot"];
    if (_0xA657 > _0x7805) {};
    var _0xA77D = 0;
    switch (_0x7805) {
        case "8":
            _0xA77D = 1;
            break;
        case "16":
            _0xA77D = 2;
            break;
        case "32":
            _0xA77D = 3;
            break;
        case "64":
            _0xA77D = 4;
            break
    };
    var _0xA7AE = 0,
        _0xA7DF = Number(_0x7DF4["prev"] ? _0x7DF4["prev"]["x"] : 0);
    if (_0x7DF4["prev"] && _0x7DF4["prev"]["type"] == 14) {
        _0xA7DF = Number(_0x7DF4["prev"]["prev"] ? _0x7DF4["prev"]["prev"]["x"] : 0)
    };
    if (_0x7DF4["next"]) {
        _0xA7AE = Number(_0x7DF4["next"]["x"]) - _0xA7DF
    } else {
        _0xA7AE = (Number(_0x7DF4["x"]) - _0xA7DF) * 2
    };
    space = (_0xA7AE - 1 - _0xA657 * Number(_0x6ED5)) / (_0xA657 + 1);
    if (_0x7DF4["prev"] && _0x7DF4["prev"]["type"] != 0) {
        space -= Number(_0x6ED5) / (_0xA657 + 1)
    };
    if (_0x7DF4["next"] && /:/ ["test"](_0x7DF4["next"]["bar_type"])) {
        space -= Number(4 + 2 + 2) / (_0xA657 + 1)
    };
    var _0xA810 = _0xA7DF + 1;
    if (_0x7DF4["prev"] && _0x7DF4["prev"]["type"] != 0) {
        _0xA810 += Number(_0x6ED5)
    };
    var _0xA6EA = 0;
    for (var _0xA688 = _0xA657, _0x6D1C = 0; _0xA688 > 0;) {
        var _0xA6B9 = [];
        for (var _0x77A3 = 0; _0x77A3 < beatArr["length"]; _0x77A3++) {
            if (_0xA688 >= beatArr[_0x77A3][0]) {
                _0xA6B9 = beatArr[_0x77A3][1];
                _0xA688 -= beatArr[_0x77A3][0];
                break
            }
        };
        for (var _0x736D = 0; _0x736D < _0xA6B9["length"]; _0x736D++) {
            for (var _0x7526 = 0; _0x7526 < _0xA6B9[_0x736D]["length"]; _0x7526++) {
                var _0xA841 = _0xA810 + Number(_0x6ED5) * _0x6D1C + space * (_0x6D1C + 1);
                drawIns["drawNote"]("0", abc["sx"](_0xA841), _0x982D, null, _0x6D1C);
                if (_0x6D1C == 0) {
                    drawIns["drawRect"](abc["sx"](_0xA841 - 2), _0x982D - abc["sh"](_0x6CEB), abc["sh"](_0x6ED5 + 4), abc["sh"](_0x6CEB + 4))
                };
                var _0x9738 = _0x982D;
                for (var _0x82BD = 0; _0x82BD < _0xA77D; _0x82BD++) {
                    _0x9738 += underlineSpace;
                    var _0x988F = _0xA841;
                    drawIns["drawLine"](abc["sx"](translateValue(_0x6E73, _0x988F)), _0x9738, underlineLen);
                    var _0xA71B = _0xA841;
                    if (_0x7526 < _0xA6B9[_0x736D]["length"] - 1) {
                        drawIns["drawLine"](abc["sx"](translateValue(_0x6E73, _0xA71B)), _0x9738, space + Number(_0x6ED5))
                    }
                };
                if (_0x736D == _0xA6B9["length"] - 1) {
                    _0xA6EA = _0xA841
                };
                _0x6D1C++
            }
        }
    };
    return _0xA6EA
}

function eq(_0xA0FB, _0xA12C) {
    return new RegExp("(" + _0xA0FB["replace"](/\,/g, "|") + ")")["test"](_0xA12C)
}

function eightDegreesChange(_0x7DC3, _0x8040) {
    var _0x9FD5 = getAbcKeyValue($("#source")["val"](), "octave");
    if (!_0x9FD5) {
        return _0x8040
    };
    _0x9FD5 = _0x9FD5["replace"]("=", "");
    if (_0x9FD5 == 0) {
        return _0x8040
    };
    _0x8040 = _0x8040["replace"](/([A-Z])\'/g, function($1) {
        if ($1) {
            return $1["replaceAll"]("\'", "")["toLowerCase"]()
        }
    });
    _0x8040 = _0x8040["replace"](/([a-z]),/g, function($1) {
        if ($1) {
            return $1["replaceAll"](",", "")["toUpperCase"]()
        }
    });
    var _0xA068 = ",,,,,,,,,";
    var _0xA099 = "\'\'\'\'\'\'\'\'\'";
    if (/[A-Z]/g ["test"](_0x8040)) {
        if (_0x9FD5 < 0) {
            _0x8040 = _0x8040 + _0xA068["slice"](0, Math["abs"](_0x9FD5))
        } else {
            for (var _0x6D1C = 1, _0x77A3 = 0; _0x6D1C <= Math["abs"](_0x9FD5); _0x6D1C++, _0x77A3++) {
                var _0xA006 = _0x8040["match"](/,/g);
                var _0xA037 = _0xA006 ? _0xA006["length"] : 0;
                var _0x9FA4 = _0xA037 - _0x77A3;
                if (_0x9FA4 > 0) {
                    _0x8040 = _0x8040["slice"](0, -1)
                } else {
                    if (-1 == _0x9FA4) {
                        _0x8040 = _0x8040["toLowerCase"]()
                    } else {
                        _0x8040 = _0x8040 + "\'"
                    }
                }
            }
        }
    } else {
        if (_0x9FD5 > 0) {
            _0x8040 = _0x8040 + _0xA099["slice"](0, _0x9FD5)
        } else {
            for (var _0x6D1C = 1, _0x77A3 = 0; _0x6D1C <= Math["abs"](_0x9FD5); _0x6D1C++, _0x77A3++) {
                var _0xA006 = _0x8040["match"](/\'/g);
                var _0xA037 = _0xA006 ? _0xA006["length"] : 0;
                var _0x9FA4 = _0xA037 - _0x77A3;
                if (_0x9FA4 > 0) {
                    _0x8040 = _0x8040["slice"](0, -1)
                } else {
                    if (-1 == _0x9FA4) {
                        _0x8040 = _0x8040["toUpperCase"]()
                    } else {
                        _0x8040 = _0x8040 + ","
                    }
                }
            }
        }
    };
    return _0x8040
}

function getSplnum2note(_0x6FFB, _0x6E73, _0x8104, _0x7DC3, _0x6D7E) {
    var _0x8040 = null,
        _0x800F = null;
    if (_0x6E73 != "rest" && isFixedMode == 0) {
        _0x800F = getToneMark(_0x7DC3, _0x8104["key"], true);
        _0x6FFB = eightDegreesChange(_0x7DC3, getNote(_0x6FFB));
        _0x8040 = getSimpleNameByKAndStaff(_0x800F, getNote(_0x6FFB), _0x7DC3, _0x6D7E["st"], _0x6D7E["istart"]);
        if (!_0x8040) {
            _0x8040 = "X"
        }
    } else {
        _0x8040 = note2number(_0x6FFB)
    };
    if (isRhythm(_0x6D7E)) {
        _0x8040 = _0x8040["replace"](/\d/, "X")
    };
    if (_0x6D7E["a_stk"] && _0x6D7E["a_stk"]["length"]) {
        if (_0x6D7E["a_stk"][0]["t"] && _0x6D7E["a_stk"][0]["t"] != "{" && _0x6D7E["a_stk"][0]["t"] != "}") {
            _0x8040 = _0x8040["replace"](/\d|X/g, _0x6D7E["a_stk"][0]["t"])
        }
    };
    var _0xB07C = _0x6FFB["replaceAll"]("/", "")["replaceAll"](",", "")["replaceAll"]("\'", "");
    if (abc["isExtendChar"](_0xB07C)) {
        _0x8040 = _0x8040["replace"](/\d/, abc["getExtendObject"](_0xB07C)["show_char"])
    };
    if (eq("140,141", _0x6D7E["p_v"]["instr"])) {
        _0x8040 = _0x8040["replace"](/\d/, "X")
    };
    return _0x8040
}
var DrawUtil = function() {};
DrawUtil["prototype"] = {
    init: function(_0x6D7E) {
        this["curS"] = _0x6D7E
    },
    drawDot: function(_0x6F06, _0x6F37, _0x6ED5) {
        var _0x6D7E = this["curS"];
        if (!(_0x6D7E["dots"] && _0x6D7E["dots"] > 0 && _0x6D7E["nflags"] >= 0)) {
            return
        };
        for (var _0x6D1C = 0; _0x6D1C < _0x6D7E["dots"]; _0x6D1C++) {
            var _0x6F68 = (splSx(_0x6F06) + Number(_0x6D7E["wl"] || 2) + Number(_0x6ED5) + 4 * _0x6D1C + 3);
            if (_0x6D7E["next"] && _0x6F68 + 4 > _0x6D7E["next"]["x"]) {
                _0x6F68 -= 4
            };
            abc["out_svg"]("<circle cx=\"" + (_0x6F68) + "\" ");
            abc["out_svg"](" cy=\"" + (_0x6F37 - abc["sh"](3)) + "\" r=\".7\" stroke=\"black\" stroke-width=\"1\"/>")
        }
    },
    drawSharpSign: function(_0x6FFB, _0x6F06, _0x6F37) {
        if (_0x6FFB["match"](/\^+|\_+|=/)) {
            var _0x6FCA = "";
            var _0x6F99 = _0x6FFB["match"](/\^+|\_+|=/)[0]["replace"](/\^+|\_+|=/g, function(_0x6F06) {
                switch (_0x6F06) {
                    case "^^":
                        _0x6FCA = "acc1";
                        return "&#x1d12a;";
                    case "^":
                        _0x6FCA = "acc1";
                        return "\u266f";
                    case "=":
                        _0x6FCA = "acc3";
                        return "\u266e";
                    case "_":
                        _0x6FCA = "acc-1";
                        return "\u266d"
                };
                return "&#x1d12b;"
            });
            var _0x702C = ("&#x1d12a;" == _0x6F99);
            abc["out_svg"]("<text type=\"" + _0x6FCA + "\" text-anchor=\"middle\" style=\"font-size: " + (_0x702C ? "20px" : "12px") + "\" x=\"" + _0x6F06 + "\" ");
            abc["out_svg"]("y=\"" + (_0x702C ? (_0x6F37 + abc["sh"](3)) : _0x6F37) + "\" height=\"24\">" + _0x6F99 + "</text>");
            return 4
        };
        return 0
    },
    drawNote: function(_0x7121, _0x6F06, _0x6F37, _0x70BF, _0x70F0) {
        var _0x705D = "";
        if (this["curS"]["a_gch"]) {
            for (var _0x6D1C = 0; _0x6D1C < this["curS"]["a_gch"]["length"]; _0x6D1C++) {
                var _0x6E42 = this["curS"]["a_gch"][_0x6D1C]["text"];
                var _0x6EA4 = /url\((.*)\)/;
                if (_0x6EA4["test"](_0x6E42)) {
                    _0x705D = "color:red;"
                }
            }
        };
        var _0x7152 = "";
        var _0x708E = getFirstNoteSeq();
        if (this["curS"]["istart"] == parseInt(update_note_istart) + (parseInt(_0x708E) - parseInt(lastFirstNoteSeq)) && _0x70F0 == update_note_index && musicType == 2) {
            _0x7152 = "selected_text"
        };
        abc["out_svg"]("<text type=\"note\" istart=\"" + this["curS"]["istart"] + "\" class=\"" + _0x7152 + " splnum f1 splfont " + this["curS"]["istart"] + "_" + this["curS"]["ctype"] + "\" ");
        abc["out_svg"]("style=\"" + _0x705D + (_0x7121 == "X" ? "font-size:16px;" : "") + (_0x70BF ? ("font-size:" + _0x70BF + "px;") : "") + "\" x=\"" + translateValue(this["curS"]["ctype"], _0x6F06) + "\" ");
        abc["out_svg"]("y=\"" + _0x6F37 + "\" height=\"24\" update_index=\"" + _0x70F0 + "\">" + _0x7121 + "</text>")
    },
    drawSplMeter: function(_0x71B4, _0x6F06, _0x6F37, _0x71E5, _0x6ED5, _0x6CEB, _0x7183) {
        if (hasTempo && _0x71B4 == lastMeter && !abc["cfmt"]()["showmeterinstaff"] && this["curS"]["a_meter"]["length"] == 0) {
            lastMeter = _0x71B4;
            return
        };
        var _0x7216 = abc["tgls"];
        _0x71B4 = getMeter(_0x71B4);
        if (!_0x71B4) {
            return
        };
        abc["out_svg"]("<g type=\"meter\" class=\"spl_meter\"");
        abc["out_svg"]("transform=\"translate(" + abc["sx"](_0x6F06) + "," + _0x6F37 + ") " + (_0x71E5 ? "scale(" + _0x71E5 + ")" : "") + "\" ");
        abc["out_svg"]("text-anchor=\"middle\">");
        abc["out_svg"]("<text type=\"meter\" y=\"-17\">");
        abc["out_svg"](_0x7216[METER + _0x71B4["top"]]["c"]);
        abc["out_svg"]("</text>");
        abc["out_svg"]("<path type=\"meter\" class=\"stroke\" stroke-width=\"1.2\" d=\"m-6,-8h12z\"/>");
        abc["out_svg"]("<text type=\"meter\" x=\"-0\">" + _0x7216[METER + _0x71B4["bot"]]["c"] + "</text>");
        if (_0x6ED5 && _0x6CEB) {
            if (_0x7183) {
                drawIns["drawRect"](-6, -_0x6CEB + this["curS"]["wr"] / 2, _0x6ED5, _0x6CEB, -1, null, null, _0x7183)
            } else {
                drawIns["drawRect"](-_0x6ED5 + this["curS"]["wr"] / 2 + 5, -_0x6CEB + this["curS"]["wr"] / 2, _0x6ED5, _0x6CEB, -1)
            }
        };
        abc["out_svg"]("</g>");
        hasTempo = true;
        lastMeter = _0x71B4
    },
    drawSplMeterPlaceholder: function(_0x6F06, _0x6F37, _0x7247) {
        abc["out_svg"]("<rect type=\"splplaceholder\" x=\"" + _0x6F06 + "\" ");
        abc["out_svg"]("y=\"" + _0x6F37 + "\" width=\"" + abc["sh"](6) + "\" height=\"" + abc["sh"](2) + "\" fill=\"block\"/>")
    },
    drawSplMode: function(_0x6F06, _0x6F37, _0x72DA, _0x72A9, _0x71E5) {
        if (hasTempo && _0x72DA == lastTone) {
            return
        };
        var _0x730B = "";
        if (!tmVal2key[_0x72DA]) {
            splerror("\u627e\u4e0d\u5230\u7b80\u8c31\u7684\u8c03\u53f7$1", _0x72DA)
        } else {
            _0x730B = tmVal2key[_0x72DA]["replace"](/[,\']*/g, "")["toUpperCase"]()
        };
        if (!_0x72A9) {
            _0x6F06 += tempoMgL
        };
        var _0x7278 = 0;
        if (_0x72A9) {
            _0x7278 = abc["setStrwh"]("\u8f6c")[0]
        };
        abc["out_svg"]("<g type=\"key\" class=\"spl_meter_mode\" style=\"font-family:serif; font-weight:bold; font-size:15px\" ");
        abc["out_svg"]("transform=\"translate(" + (abc["sx"](_0x6F06 + _0x7278) - 15) + "," + _0x6F37 + ") " + (_0x71E5 ? " scale(" + _0x71E5 + ")" : "") + "\" ");
        abc["out_svg"]("text-anchor=\"middle\">");
        abc["out_svg"]("<text type=\"key\" >" + (_0x72A9 ? "\u8f6c" : "") + "1</text>");
        abc["out_svg"]("<text type=\"key\" x=\"" + (10 + _0x7278) + "\">=</text>");
        var _0x733C = this["drawSharpSign"](_0x730B, 18 + _0x7278, -5);
        abc["out_svg"]("<text type=\"key\" x=\"" + (18 + _0x7278 + _0x733C) + "\" text-anchor=\"start\">" + _0x730B["replace"](/\^+|\_+|=/g, "") + "</text>");
        abc["out_svg"]("</g>");
        if (this["curS"]["p_v"]["ckey"]) {
            this["drawRect"](abc["sx"](_0x6F06 + _0x7278 - 3), _0x6F37 - abc["setStrwh"]("0")[1] + 3, 28 + _0x733C, abc["setStrwh"]("0")[1], -1, null, null, this["curS"]["p_v"]["ckey"]["istart"])
        };
        _0x6F06 += 28 + _0x733C + abc["setStrwh"]("2")[0] + 3;
        lastTone = _0x72DA;
        return _0x6F06
    },
    drawLine: function(_0x6F06, _0x6F37, _0x7247) {
        abc["out_svg"]("<line x1=\"" + _0x6F06 + "\" y1=\"" + _0x6F37 + "\" x2=\"" + (_0x7247 + _0x6F06) + "\" y2=\"" + _0x6F37 + "\" class=\"splnum stroke\" stroke-width=\"1\" fill=\"black\"/>")
    },
    drawPlaceholder: function(_0x6F06, _0x6F37) {
        abc["out_svg"]("<rect type=\"splplaceholder\" x=\"" + _0x6F06 + "\" ");
        abc["out_svg"]("y=\"" + _0x6F37 + "\" width=\"" + abc["sh"](6) + "\" height=\"" + abc["sh"](2) + "\" fill=\"block\"/>")
    },
    drawDot2: function(_0x6F06, _0x6F37, _0x736D, _0x6ED5, _0x6D7E) {
        for (var _0x6D1C = 0; _0x6D1C < _0x736D; _0x6D1C++) {
            abc["out_svg"]("<circle cx=\"" + (_0x6F06 + Number(_0x6ED5) + (_0x6D7E || 0) + 4 * _0x6D1C + 3) + "\" ");
            abc["out_svg"](" cy=\"" + (_0x6F37 - abc["sh"](3)) + "\" r=\".7\" stroke=\"black\" stroke-width=\"1\"/>")
        }
    },
    drawGraceTail: function(_0x6E73, _0x6F06, _0x6F37, _0x739E) {
        var _0x73CF = 5;
        abc["out_svg"]("<g transform=\"translate(" + _0x6F06 + "," + _0x6F37 + ")\">");
        abc["out_svg"]("<path class=\"splnum stroke b-grace\" stroke-width=\"1\" stroke-linecap=\"round\" stroke=\"black\" ");
        abc["out_svg"]("d=\"m1,1 c" + ("b" == _0x6E73 ? -1 : 1) + "," + _0x73CF + " 1," + _0x73CF + " " + ("b" == _0x6E73 ? -_0x739E + 2 : _0x739E) + "," + _0x73CF + "\"/>");
        abc["out_svg"]("</g>")
    },
    drawBar: function(y, x2, y2, w, h, d) {
        abc["out_svg"]("<path class=\"splnum stroke\" transform=\"translate(0," + y + ")\" " + (d?"stroke-dasharray=\"5,5\"":"") + " stroke-width=\"" + w + "\"");
        abc["out_svg"](" d=\"m" + x2 + "," + (y2 + bar_height - (bar_height - 24) * 0.5) + "v-" + (bar_height + (h || 0)) + "\"/>");
        splBarHeight = bar_height + (h || 0)
    },
    drawBracket: function(_0x7431, _0x6F06, _0x6F37, _0x6CEB) {
        abc["out_svg"]("<path type=\"bracket\"  transform=\"translate(0," + _0x7431 + ")\" class=\"fill\"\x0A\x09d=\"m" + _0x6F06["toFixed"](2) + " " + _0x6F37["toFixed"](2) + "\x0A\x09c10.5 1 12 -4.5 12 -3.5c0 1 -3.5 5.5 -8.5 5.5\x0A\x09v" + _0x6CEB["toFixed"](2) + "\x0A\x09c5 0 8.5 4.5 8.5 5.5c0 1 -1.5 -4.5 -12 -3.5\"/>\x0A")
    },
    drawRect: function(_0x6F06, _0x6F37, _0x6ED5, _0x6CEB, _0x6D1C, _0x74F5, _0x7462, _0x7183, _0x74C4, _0x7493) {
        var _0x6CBA = "";
        if (this["curS"]["ctype"] == "bar" || this["curS"]["ctype"] == "splnum_bar") {
            _0x6CBA = " onclick=\'clickBar(" + this["curS"]["istart"] + ",event)\'"
        };
        if (_0x74C4) {
            abc["out_svg"]("<rect " + _0x6CBA + "  ondblclick = \"editorAnnot(" + this["curS"]["istart"] + ")\" type=\"splnum_" + this["curS"]["ctype"] + "" + (_0x74C4 ? " ph" : "") + "\" st=\"" + this["curS"]["st"] + "\" v=\"" + this["curS"]["st"] + "\" istart=\"" + this["curS"]["istart"] + "\" class=\"abcr _" + (_0x7183 || this["curS"]["istart"]) + "_" + (_0x6D1C == -1 ? "" : (_0x74F5 || (this["curS"]["istart"] != _0x6D1C && this["curS"]["type"] != "10" ? "0" : ""))) + " rt_" + _0x6D1C + (" " + _0x7493) + "\" ")
        } else {
            abc["out_svg"]("<rect " + _0x6CBA + "  ondblclick = \"editorAnnot(" + this["curS"]["istart"] + ")\" type=\"splnum_" + this["curS"]["ctype"] + "" + (_0x74C4 ? " ph" : "") + "\" st=\"" + this["curS"]["st"] + "\" v=\"" + this["curS"]["st"] + "\" istart=\"" + this["curS"]["istart"] + "\" class=\"abcr _" + (_0x7183 || this["curS"]["istart"]) + "_ rt_" + _0x6D1C + (" " + _0x7493) + "\" ")
        };
        abc["out_svg"](((_0x74F5 !== undefined || this["curS"]["istart"] != _0x6D1C) ? (" data-index=\"" + (_0x74F5 || (this["curS"]["istart"] != _0x6D1C ? "0" : "")) + "\" ") : "") + " data-origindex=\"" + this["curS"]["istart"] + "\" data-chordindex=\"" + _0x7462 + "\" x=\"" + _0x6F06 + "\" y=\"" + _0x6F37 + "\"");
        if (this["curS"]["a_gch"]) {
            for (var _0x6D1C = 0; _0x6D1C < this["curS"]["a_gch"]["length"]; _0x6D1C++) {
                var _0x6E42 = this["curS"]["a_gch"][_0x6D1C]["text"];
                var _0x6EA4 = /url\((.*)\)/;
                if (_0x6EA4["test"](_0x6E42)) {
                    var _0x6D4D = _0x6E42["match"](_0x6EA4);
                    if (_0x6D4D != null) {
                        var _0x6B94 = _0x6D4D[1];
                        abc["out_svg"](" onclick=\"window.open(\'" + _0x6B94 + "\')\"");
                        abc["out_svg"](" style=\"cursor: pointer;\"")
                    }
                }
            }
        };
        abc["out_svg"](" width=\"" + _0x6ED5 + "\" height=\"" + _0x6CEB + "\"/>\x0A")
    },
    drawDeco: function(_0x6F06, _0x6F37, _0x792B) {
        var _0x6D7E = this["curS"],
            _0x7772 = false;
        if (isSameByline != (_0x6D7E["my_line"] + "" + _0x6D7E["v"])) {
            var _0x75EA = abc["clone"](_0x6D7E);
            for (var _0x7867 = _0x75EA["next"]; _0x7867; _0x7867 = _0x7867["next"]) {
                if (checkNoteInDimOrCresc(_0x6D7E)) {
                    _0x7772 = true
                }
            };
            isSameByline = _0x6D7E["my_line"] + "" + _0x6D7E["v"]
        };
        isExistDimByLine = _0x7772;
        var _0x7588 = abc["clone"](_0x6D7E["a_dd"]);
        var _0x767D = false;
        if (_0x7588 && _0x7588["length"]) {
            var _0x77D4 = 0,
                _0x761B = _0x6F06;
            for (var _0x6D1C = 0; _0x6D1C < _0x7588["length"]; _0x6D1C++) {
                var _0x76DF = _0x7588[_0x6D1C]["glyph"];
                var _0x764C = getDecoPos(_0x6D7E["istart"], _0x76DF);
                if (_0x764C && (!_0x6D7E["calDecoPos"] || _0x6D7E["calDecoPos"]["indexOf"](_0x76DF) < 0)) {
                    if (!_0x6D7E["calDecoPos"]) {
                        _0x6D7E["calDecoPos"] = []
                    };
                    _0x6D7E["calDecoPos"]["push"](_0x76DF);
                    _0x761B += _0x764C["x"];
                    _0x6F37 -= _0x764C["y"]
                };
                if (_0x767D) {
                    _0x6F37 = _0x6F37 - 30;
                    _0x767D = false
                };
                var _0x7741 = false;
                if (!_0x7588[_0x6D1C]["glyph"] || _0x7588[_0x6D1C]["dd_en"] || _0x7588[_0x6D1C]["dd_st"]) {
                    continue
                };
                if (musicType == 1) {
                    if (_0x7588[_0x6D1C]["glyph"] == "dnb" || _0x7588[_0x6D1C]["glyph"] == "upb" || _0x7588[_0x6D1C]["glyph"] == "marcato" || _0x7588[_0x6D1C]["glyph"] == "wedge" || _0x7588[_0x6D1C]["glyph"] == "accent" || _0x7588[_0x6D1C]["glyph"] == "stc" || _0x7588[_0x6D1C]["glyph"] == "tenutoup" || _0x7588[_0x6D1C]["glyph"] == "opend" || _0x7588[_0x6D1C]["glyph"] == "dplus" || _0x7588[_0x6D1C]["glyph"] == "snap" || _0x7588[_0x6D1C]["glyph"] == "trl" || _0x7588[_0x6D1C]["glyph"] == "umrd" || _0x7588[_0x6D1C]["glyph"] == "lmrd" || _0x7588[_0x6D1C]["glyph"] == "roll" || _0x7588[_0x6D1C]["glyph"] == "turn" || _0x7588[_0x6D1C]["glyph"] == "invertedturn") {} else {
                        return
                    }
                };
                if (_0x7588[_0x6D1C]["name"] == "dot") {
                    var _0x78C9 = new Object();
                    _0x78C9["func"] = 0;
                    _0x78C9["glyph"] = "wedge";
                    _0x78C9["h"] = 7;
                    _0x78C9["name"] = "wedge";
                    _0x78C9["wl"] = 3;
                    _0x78C9["wr"] = 3;
                    xygl(_0x761B + _0x78C9["wl"] / 2, _0x6F37 - abc["sh"](_0x77D4), _0x78C9, 1, null, _0x6D7E);
                    return
                };
                var _0x798D = 0,
                    _0x795C = 0;
                var _0x76AE = false;
                if (_0x6D7E["type"] == 0 && _0x6D7E["next"] && _0x6D7E["next"]["a_dd"] && _0x7588[_0x6D1C]["glyph"]) {
                    var _0x7836 = _0x6D7E["next"]["a_dd"];
                    for (var _0x77A3 = 0; _0x77A3 < _0x7836["length"]; _0x77A3++) {
                        if (eq("f,p", _0x7836[_0x77A3]["name"])) {
                            _0x77D4 += 15;
                            _0x76AE = true
                        } else {
                            _0x77D4 += abc["sh"](_0x7836[_0x77A3]["h"]) + 5
                        }
                    }
                };
                var _0x7710 = _0x7588[_0x6D1C]["glyph"];
                if (eqs("stc", _0x7710)) {
                    _0x761B += 2
                };
                if (eqs("wedge", _0x7710)) {} else {
                    if (eqs("turnx,sphr,turn", _0x7710)) {
                        _0x761B += 2;
                        _0x6F37 -= 3
                    } else {
                        if (eqs("coda", _0x7710)) {
                            _0x761B -= 2;
                            _0x6F37 -= 8;
                            if (_0x7588["find"](function(_0x7526) {
                                    return _0x7526["glyph"] == "dacs"
                                })) {
                                _0x6F37 -= 18
                            }
                        } else {
                            if (eqs("l_brackets,r_brackets_l,r_brackets_r", _0x7710)) {
                                if ("l_brackets" == _0x7710) {
                                    _0x798D = 4;
                                    _0x795C = 1
                                } else {
                                    if ("r_brackets_l" == _0x7710 || "r_brackets_r" == _0x7710) {
                                        if ("r_brackets_l" == _0x7710) {
                                            _0x795C = -15;
                                            if (_0x6D7E["bar_type"] && _0x6D7E["bar_type"]["indexOf"](":") > -1) {
                                                _0x795C -= 10
                                            }
                                        } else {
                                            _0x795C = 3
                                        };
                                        _0x798D += 2;
                                        if (_0x76AE) {
                                            _0x798D += 15
                                        }
                                    }
                                }
                            } else {
                                if (eq("brth", _0x7710)) {
                                    _0x761B += 8
                                } else {
                                    if (eq("lmrd", _0x7710)) {
                                        _0x6F37 -= 3
                                    } else {
                                        if (eq("upb", _0x7710)) {
                                            _0x761B -= _0x7588[_0x6D1C]["wl"] + 3;
                                            _0x6F37 += 10
                                        } else {
                                            if (eq("pf", _0x7710)) {
                                                _0x761B -= _0x7588[_0x6D1C]["wl"]
                                            } else {
                                                if ("sld" == _0x7710 || "sld_spl" == _0x7710) {
                                                    _0x761B -= 17;
                                                    _0x6F37 += 10;
                                                    _0x7588[_0x6D1C]["glyph"] = "sld_spl"
                                                } else {
                                                    if ("sldlu" == _0x7710 || "sldlu_spl" == _0x7710) {
                                                        _0x761B -= 17;
                                                        _0x7588[_0x6D1C]["glyph"] = "sldlu_spl"
                                                    } else {
                                                        if ("sldrd" == _0x7710 || "sldrd_spl" == _0x7710) {
                                                            _0x761B += 5;
                                                            _0x6F37 += 5;
                                                            _0x7588[_0x6D1C]["glyph"] = "sldrd_spl"
                                                        } else {
                                                            if ("sldru" == _0x7710 || "sldru_spl" == _0x7710) {
                                                                _0x761B += 5;
                                                                _0x7588[_0x6D1C]["glyph"] = "sldru_spl"
                                                            } else {
                                                                if (eqs("dacs", _0x7710)) {
                                                                    _0x6F37 = _0x6F37 + 40;
                                                                    if (_0x6D7E["next"] && _0x6D7E["next"]["a_dd"] && _0x6D7E["next"]["a_dd"]["length"] > 0) {
                                                                        _0x6F37 = _0x6F37 + 12
                                                                    };
                                                                    _0x761B -= 20
                                                                } else {
                                                                    if (eqs("strong,sec_strong,weak", _0x7710)) {
                                                                        if (musicType == 1) {
                                                                            return
                                                                        };
                                                                        _0x761B -= 5
                                                                    } else {
                                                                        if (eq("arp", _0x7710)) {
                                                                            var _0x7898 = 10;
                                                                            if (_0x6D7E["dur_orig"] == _0x6D7E["p_v"]["meter"]["wmeasure"]) {
                                                                                if (_0x6D7E["dur_orig"] >= 1536) {
                                                                                    _0x7898 = 15
                                                                                }
                                                                            };
                                                                            out_spl_arp(splSx(_0x6D7E["x"]) - _0x7898 + _0x795C, _0x6F37 + chordHei * _0x6D7E["notes"]["length"] - 10 + _0x798D, 0, 0, chordHei * _0x6D7E["notes"]["length"] - 20);
                                                                            continue
                                                                        } else {
                                                                            if (eq("emb", _0x7710)) {
                                                                                _0x6F37 += 3
                                                                            } else {
                                                                                if (eqs("do,re,mi,fa,sol,la,si", _0x7710)) {
                                                                                    _0x767D = true;
                                                                                    _0x6F37 = _0x6F37 + 50;
                                                                                    if (getA_ddInfo(_0x6D7E, "strong")["length"] > 0 || getA_ddInfo(_0x6D7E, "weak")["length"] > 0 || getA_ddInfo(_0x6D7E, "sec_strong")["length"] > 0) {
                                                                                        _0x798D = _0x798D + 17
                                                                                    }
                                                                                }
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                };
                if (musicType != 0 && _0x6D7E["type"] != 0 && eqs("f,ff,fff,ffff,fp,pf,p,pp,ppp,pppp", _0x7588 && _0x7588[_0x6D1C]["name"])) {};
                if (isExistDimByLine && !eqs("l_brackets,r_brackets_l,r_brackets_r", _0x7710)) {
                    _0x6F37 -= 20
                };
                if (_0x6D7E["grace"]) {
                    if (musicType == 2) {
                        _0x6F37 = 0;
                        _0x761B = _0x761B - 2
                    };
                    _0x6F37 = translateValue("grace", _0x6F37);
                    _0x761B = translateValue("grace", _0x761B)
                };
                if (eq("p", _0x7710)) {
                    _0x6F37 -= 3
                };
                xygl(_0x761B + _0x7588[_0x6D1C]["wl"] / 2 + _0x795C, _0x6F37 - abc["sh"](_0x77D4) + _0x798D, _0x7588[_0x6D1C], 1, _0x7588[_0x6D1C]["anchor"], _0x6D7E);
                if (!eqs("l_brackets,r_brackets_l,r_brackets_r", _0x7710)) {
                    _0x77D4 += _0x7588[_0x6D1C]["h"] + 2
                };
                _0x761B = _0x6F06;
                _0x7588[_0x6D1C]["glyph"] = _0x7710;
                _0x792B && (_0x792B["decoPos"] = _0x77D4);
                if (_0x792B && eqs("f,ff,fff,ffff,fp,pf,p,pp,ppp,pppp", _0x7588 && _0x7588[_0x6D1C]["name"])) {
                    _0x792B && (_0x792B["decoPos"] -= 12)
                };
                if (eq("p", _0x7710)) {
                    _0x6F37 = _0x6F37 + 20
                }
            }
        };
        var _0x7557 = abc["clone"](_0x6D7E["notes"][0]["a_dcn"]);
        if (_0x7557 && _0x7557["length"]) {
            if ("~(" == _0x7557[0]) {
                if (_0x6D7E["next"]) {
                    var _0x79BE = -1;
                    var _0x79EF = -1;
                    var _0x739E = _0x6D7E["x"];
                    var _0x73CF = _0x6D7E["y"];
                    if (_0x6D7E["next"]["type"] == 8) {
                        _0x79BE = _0x6D7E["next"]["x"];
                        _0x79EF = _0x6D7E["next"]["y"]
                    } else {
                        if (_0x6D7E["next"]["type"] == 0) {
                            _0x79BE = _0x6D7E["next"]["next"]["x"];
                            _0x79EF = _0x6D7E["next"]["next"]["y"]
                        }
                    };
                    var _0x75B9 = -Math["atan2"](_0x79EF - _0x73CF, _0x79BE - _0x739E),
                        _0x7526 = _0x75B9 / Math["PI"] * 180,
                        _0x7805 = (_0x79BE - _0x739E) / Math["cos"](_0x75B9);
                    _0x739E = _0x6D7E["dots"] ? 13 + _0x6D7E["xmx"] : 8;
                    _0x7805 = (_0x7805 - _0x739E - 6) / 6 | 0;
                    if (_0x7805 < 1) {
                        _0x7805 = 1
                    }
                };
                if (_0x7526 > 0) {
                    abc["out_svg"]("<g transform=\"translate(" + (splSx(_0x6F06) + 12) + "," + (_0x6F37 + 8) + ") rotate(" + _0x7526["toFixed"](2) + ")\">")
                } else {
                    abc["out_svg"]("<g transform=\"translate(" + (splSx(_0x6F06) + 12) + "," + (_0x6F37 + 20) + ") rotate(" + _0x7526["toFixed"](2) + ")\">")
                };
                var _0x78FA = 0;
                while (--_0x7805 >= 0) {
                    abc["out_svg"]("<use x=\"" + _0x78FA + "\" y=\"" + (0) + "\" xlink:href=\"#ltr\"/>\x0A");
                    _0x78FA += 6
                };
                abc["out_svg"]("</g>")
            }
        };
        if (_0x6D7E["trem1"]) {
            abc["out_svg"]("<use x=\"" + (splSx(_0x6D7E["x"])) + "\" y=\"" + (0) + "\" xlink:href=\"#zy" + _0x6D7E["ntrem"] + "\"/>\x0A")
        }
    },
    drawGch: function(_0x6F06, _0x6F37) {
        if (musicType == 1) {
            return
        };
        var _0x6D7E = this["curS"],
            _0x7A51 = 0;
        var _0x7588 = abc["clone"](_0x6D7E["a_dd"]);
        if (_0x6D7E["prev"] && _0x6D7E["prev"]["splnum_trans_key"]) {
            _0x7A51 = 5
        };
        var _0x7A20 = abc["clone"](_0x6D7E["a_gch"]);
        if (_0x7A20 && _0x7A20["length"]) {
            _0x7A20["reverse"]();
            abc["set_font"]("annotation");
            var _0x77D4 = 0,
                _0x761B = _0x6F06,
                _0x6CEB = abc["setStrwh"]("\u6ce8")[1] + 2;
            _0x6F37 -= _0x7A51;
            var _0x6EA4 = /url\(.*\)/;
            var _0x7C9D = new RegExp(/^\([,']([0-9]+)\-$/);
            var _0x7C6C = new RegExp(/^\-([0-9]+)\)$/);
            var _0x7C3B = new RegExp(/^\(arp[0-9]+\-$/);
            var _0x7C0A = new RegExp(/^\-[0-9]+arp\)$/);
            if ((_0x6D7E["slur_start"] != null || _0x6D7E["slur_end"] != null || _0x6D7E["ti1"] || "tie_s" in _0x6D7E || "sls" in _0x6D7E || "sl1" in _0x6D7E || "tp" in _0x6D7E) && !_0x6D7E["a_dd"]) {
                _0x6F37 -= 10
            };
            if (musicType == 2 && (_0x6D7E["ti1"] || "tie_s" in _0x6D7E || "sls" in _0x6D7E || "sl1" in _0x6D7E || "tp" in _0x6D7E) && _0x6D7E["a_dd"] && _0x6D7E["a_dd"][0]["glyph"] == "dim") {
                _0x6F37 -= _0x6D7E["a_dd"][0]["h"]
            };
            for (var _0x6D1C = 0; _0x6D1C < _0x7A20["length"]; _0x6D1C++) {
                if (_0x6EA4["test"](_0x7A20[_0x6D1C]["text"]) || _0x7C9D["test"](_0x7A20[_0x6D1C]["text"]) || _0x7C6C["test"](_0x7A20[_0x6D1C]["text"]) || _0x7C3B["test"](_0x7A20[_0x6D1C]["text"]) || _0x7C0A["test"](_0x7A20[_0x6D1C]["text"])) {
                    continue
                };
                if (_0x7A20[_0x6D1C]["text"]["indexOf"]("fermatatime:") == 0) {
                    continue
                };
                if (_0x7A20[_0x6D1C]["text"]["indexOf"]("jptext:") == 0) {
                    continue
                };
                if (_0x7A20[_0x6D1C]["text"]["indexOf"]("tpheight:") == 0) {
                    continue
                };
                if (_0x7A20[_0x6D1C]["text"]["indexOf"]("barwidth:") == 0) {
                    continue
                };
                if (_0x7A20[_0x6D1C]["text"]["indexOf"]("{x:") == 0) {
                    continue
                };
                if (musicType == 1) {
                    if (_0x7A20[_0x6D1C]["text"]["indexOf"]("fng:") == 0) {
                        continue
                    }
                };
                if (_0x7A20[_0x6D1C]["text"] && _0x7A20[_0x6D1C]["text"]["indexOf"]("rgb") > -1) {
                    continue
                };
                var _0x6E73 = _0x7A20[_0x6D1C]["type"];
                if (_0x6D1C != 0) {
                    _0x6F37 -= abc["sh"](_0x6CEB)
                };
                if (!isChinese2txt(_0x7A20[_0x6D1C]["text"])) {
                    _0x6F37 -= 6
                };
                if (_0x7A20[_0x6D1C]["text"] && !_0x7A20[_0x6D1C]["text"]["repeat"](/\s/g, "")) {
                    _0x6F37 += _0x6CEB * 0.5
                };
                if (_0x7A20[_0x6D1C]["text"] == "\u30b5") {
                    _0x6F37 += 18;
                    _0x6F06 -= 30
                };
                if (isChinese2txt((_0x7A20[_0x6D1C]["text"] ? _0x7A20[_0x6D1C]["text"][0] : ""))) {
                    _0x6F37 -= _0x6CEB * 0.5
                };
                var _0x6C89 = _0x7A20[_0x6D1C]["text"];
                var _0x7BA8 = 0,
                    _0x7BD9 = 0;
                var _0x7B46 = "";
                if (_0x6E73 == "<" || _0x6E73 == ">") {
                    var _0x7B77 = _0x6C89["match"](/^\[(.[^\[]*)\]/);
                    if (_0x7B77 != null) {
                        _0x7BA8 = _0x7B77[1]["split"](",")[0];
                        _0x7BD9 = _0x7B77[1]["split"](",")[1]
                    };
                    _0x6C89 = _0x6C89["replace"](/^\[.[^\[]*\]/, "");
                    _0x6F06 += parseInt(_0x7BA8) + scale;
                    if (_0x6E73 == "<") {
                        _0x6F06 += scale * 1.5
                    };
                    _0x6F37 += parseInt(_0x7BD9);
                    _0x7B46 = " splfont "
                };
                if (_0x6C89["indexOf"]("-mb-") == 0 || nbReg["test"](_0x6C89)) {
                    continue
                };
                if (_0x6C89["indexOf"]("midi") == 0) {
                    continue
                };
                if (_0x6C89["indexOf"]("x-in:") > -1) {
                    continue
                };
                if (_0x6C89["indexOf"]("{\'gchtype\':") > -1) {
                    continue
                };
                if (_0x6C89["indexOf"]("-bk-") == 0 || _0x6C89["indexOf"]("-v-") == 0) {
                    continue
                };
                if (_0x6C89["indexOf"]("sh:") == 0) {
                    continue
                };
                if (_0x6C89["indexOf"]("(slur-") > -1 || _0x6C89["indexOf"](")slur-") > -1) {
                    continue
                };
                if (/\[-\d/ ["test"](_0x6C89) || /\d{1,3}\-\]/ ["test"](_0x6C89)) {
                    continue
                };
                var _0x7CFF = _0x6C89["match"](xcoorGchReg);
                var _0x7D61 = _0x6C89["match"](ycoorGchReg);
                var _0x7D30 = 0;
                var _0x7D92 = 0;
                if (_0x7CFF != null) {
                    _0x7D30 = parseInt(_0x7CFF[1]);
                    _0x6F06 += _0x7D30
                };
                if (_0x7D61 != null) {
                    _0x7D92 = parseInt(_0x7D61[1]);
                    _0x6F37 -= _0x7D92
                };
                if (_0x6C89["indexOf"]("fng:") > -1) {
                    _0x6C89 = _0x6C89["replace"]("fng:", "");
                    _0x6F06 += 5;
                    _0x6F37 += 5;
                    abc["out_svg"]("<text x=\"" + splSx(_0x6F06 + _0x7A20[_0x6D1C]["x"]) + "\" y=\"" + _0x6F37 + "\" class=\"fng\">" + _0x6C89 + "</text>\x0A")
                } else {
                    if (_0x7A20[_0x6D1C]["type"] != "@") {
                        var _0x7CCE = "";
                        if (xcoorGchReg["test"](_0x6C89) || ycoorGchReg["test"](_0x6C89)) {
                            _0x6C89 = _0x6C89["replace"](xcoorGchReg, "")["replace"](ycoorGchReg, "")
                        };
                        if (_0x6C89["indexOf"]("[font-size") > -1) {
                            var _0x7AE4 = /\[(font-size:.*)\]/ ["exec"](_0x6C89);
                            if (_0x7AE4 != null) {
                                _0x7CCE += /\[(font-size:.*)\]/ ["exec"](_0x6C89)[1];
                                _0x6C89 = _0x6C89["replace"](/\[(font-size:.*)\]/, "")
                            }
                        };
                        var _0x7AB3 = "";
                        var _0x7B15 = "";
                        _0x7AB3 = " onmousemove=\'moveSvgText(event)\' onmousedown=\'mousedownSvgText(event)\' onmouseup=\'mouseupSvgText(event)\' onmouseout=\'mouseoutSvgText(event)\'";
                        var _0x7A82 = _0x6D7E["a_gch"][_0x6D1C];
                        _0x7B15 += " gch_istart=\"" + _0x7A82["istart"] + "\" gch_iend=\"" + _0x7A82["iend"] + "\" ";
                        // abc["out_svg"]("<text ondblclick=\"editorAnnot(" + _0x6D7E["istart"] + ")\" istart=\"" + _0x6D7E["istart"] + "\" type=\"zs\"" + _0x7AB3 + _0x7B15 + " xml:space=\"preserve\" style=\"" + _0x7CCE + "\" x=\"" + splSx(_0x6F06 + _0x7A20[_0x6D1C]["x"]) + "\" y=\"" + _0x6F37 + "\" class=\"" + _0x7B46 + "f" + _0x7A20[_0x6D1C]["font"]["fid"] + "\">" + _0x6C89 + "</text>\x0A")
                        abc["out_svg"]("<text ondblclick=\"editorAnnot(" + _0x6D7E["istart"] + ")\" istart=\"" + _0x6D7E["istart"] + "\" type=\"zs\"" + _0x7AB3 + _0x7B15 + " xml:space=\"preserve\" style=\"" + _0x7CCE + "\" x=\"" + splSx(_0x6F06 + _0x7A20[_0x6D1C]["x"]) + "\" y=\"" + (_0x6F37+10) + "\" class=\"" + _0x7B46 + "f" + _0x7A20[_0x6D1C]["font"]["fid"] + "\">" + _0x6C89 + "</text>\x0A")
                    }
                }
            }
        }
    },
    drawBarnum: function(_0x6F06, _0x6F37, _0x74F5) {
        return;
        var _0x6D7E = this["curS"],
            _0x7A51 = 0;
        while (_0x6D7E["v"] != 0) {
            _0x6D7E = _0x6D7E["ts_prev"];
            if (!_0x6D7E) {
                return
            }
        };
        if (!_0x74F5) {
            if (_0x6D7E["bar_num"] && !_0x6D7E["next"]) {
                lastBarNumMap[_0x6D7E["my_line"]] = _0x6D7E["bar_num"] || ""
            };
            if (!_0x6D7E["bar_num"] || !_0x6D7E["next"]) {
                return
            }
        };
        var _0x7588 = abc["clone"](_0x6D7E["a_dd"]);
        if (_0x7588 && _0x7588["length"]) {
            var _0x77D4 = 0,
                _0x761B = _0x6F06;
            for (var _0x77A3 = 0; _0x77A3 < _0x7588["length"]; _0x77A3++) {
                if (!_0x7588[_0x77A3]["glyph"] || _0x7588[_0x77A3]["dd_en"] || _0x7588[_0x77A3]["dd_st"]) {
                    continue
                };
                _0x7A51 += _0x7588[_0x77A3]["h"]
            }
        };
        abc["set_font"]("measure");
        abc["out_svg"]("<text x=\"" + splSx(_0x6F06) + "\" y=\"" + (_0x6F37 - _0x7A51 - 3) + "\" class=\"" + abc["font_class"](abc["gene"]()["curfont"]) + "\">" + (_0x74F5 ? _0x74F5 : _0x6D7E["bar_num"]) + "</text>\x0A")
    }
};

function xygl(_0x6F06, _0x6F37, _0xCB48, _0xCC3D, _0xCBAA, _0x6D7E) {
    var _0x76DF = _0xCB48["glyph"];
    var _0xCB79 = abc["get_deco_str_style"][_0x76DF];
    if (_0xCB48["str"] && _0xCB79) {
        if (!_0xCB79["def"]) {
            abc["add_style"]("\x0A." + _0x76DF + " {" + _0xCB79["style"] + "}")
        };
        var _0xCBDB = _0xCB79["anchor"];
        if (_0xCBAA) {
            if (_0xCBDB) {
                _0xCBDB = _0xCBDB["replace"]("middle", _0xCBAA)
            }
        };
        abc["out_svg"]("<text x=\"" + splSx(_0x6F06) + "\" y=\"" + _0x6F37 + "\" cat=\"decos\" istart=\"" + _0x6D7E["istart"] + "\" type=\"" + _0x76DF + "\" class=\"" + _0x76DF + "\" " + (_0xCBDB || "") + ">" + _0xCB48["str"] + "</text>\x0A");
        return
    };
    var _0xCC9F = abc["tgls"][_0x76DF];
    var _0xCC0C = abc["get_glyphs"]();
    if (_0xCC9F && !_0xCC0C[_0x76DF]) {
        _0x6F06 += _0xCC9F["x"] * abc["stv_g"]()["scale"];
        _0x6F37 += _0xCC9F["y"];
        if (_0xCC9F["sc"]) {
            abc["out_svg"]("<text cat=\"decos\" type=\"" + _0x76DF + "\" istart=\"" + _0x6D7E["istart"] + "\" transform=\"translate(" + splSx(_0x6F06) + "," + _0x6F37 + ") scale(" + _0xCC9F["sc"] + ")\">" + _0xCC9F["c"] + "</text>\x0A")
        } else {
            abc["out_svg"]("<text x=\"" + splSx(_0x6F06) + "\" y=\"" + _0x6F37 + "\" cat=\"decos\" type=\"" + _0x76DF + "\" istart=\"" + _0x6D7E["istart"] + "\">" + _0xCC9F["c"] + "</text>\x0A")
        };
        return
    };
    if (!_0xCC0C[_0x76DF]) {
        return
    };
    abc["def_use"](_0x76DF, _0xCB48["path"]);
    if (_0x76DF == "img") {
        if (musicType == 2) {
            var _0x9F73 = _0xCB48["pos"];
            var _0x7898 = 0;
            var _0xCC6E = 0;
            if (_0x9F73 == "<") {
                _0x7898 = -20;
                _0xCC6E = 35
            };
            if (_0xCB48 && _0xCB48["path"] && _0xCB48["path"]["indexOf"]("http") == 0) {
                abc["out_svg"]("<use x=\"" + (splSx(_0x6F06 + _0x7898)) + "\" y=\"" + (_0x6F37 + _0xCC6E) + "\" cat=\"decos\" type=\"" + _0x76DF + "\" istart=\"" + _0x6D7E["istart"] + "\" xlink:href=\"#" + _0xCB48["path"]["replace"](/[.:/]/g, "") + "\"/>\x0A")
            } else {
                abc["out_svg"]("<use x=\"" + (splSx(_0x6F06 + _0x7898)) + "\" y=\"" + (_0x6F37 + _0xCC6E) + "\" cat=\"decos\" type=\"" + _0x76DF + "\" istart=\"" + _0x6D7E["istart"] + "\" xlink:href=\"#" + _0x76DF + "_" + _0xCB48["path"] + "\"/>\x0A")
            }
        }
    } else {
        if ("r_brackets_l" == _0x76DF || "r_brackets_r" == _0x76DF || "l_brackets" == _0x76DF) {
            if (bracketsArr["indexOf"](_0x76DF + _0x6D7E["istart"]) > -1) {
                return
            };
            bracketsArr["push"](_0x76DF + _0x6D7E["istart"])
        };
        abc["out_svg"]("<use x=\"" + splSx(_0x6F06) + "\" y=\"" + _0x6F37 + "\" cat=\"decos\" type=\"" + _0x76DF + "\" istart=\"" + _0x6D7E["istart"] + "\" xlink:href=\"#" + _0x76DF + "\"/>\x0A")
    }
}

function out_spl_arp(_0xBCBC, _0x7431, _0x6F06, _0x6F37, _0xA12C) {
    abc["out_svg"]("<defs><path id=\"ltr\" class=\"fill\"\x0A\x09d=\"m0 -.4c2 -1.5 3.4 -1.9 3.9 .4 0.2 .8 .7 .7 2.1 -.4\x0A\x09v0.8c-2 1.5 -3.4 1.9 -3.9 -.4 -.2 -.8 -.7 -.7 -2.1 .4z\"/></defs>");
    abc["out_svg"]("<g class=\"arp_spl\" transform=\"translate(" + _0xBCBC + "," + _0x7431);
    abc["out_svg"](") rotate(270");
    abc["out_svg"](")\">\x0A");
    _0x6F06 = 0;
    _0x6F37 = -4;
    _0xA12C = Math["ceil"](_0xA12C / 6);
    while (--_0xA12C >= 0) {
        abc["out_svg"]("<use x=\"" + _0x6F06 + "\" d y=\"" + _0x6F37 + "\" xlink:href=\"#ltr\"></use>");
        _0x6F06 += 6
    };
    abc["out_svg"]("</g>\x0A")
}

function checkBeam(_0x6E73, _0x7DC3, _0x7DF4) {
    if (_0x6E73 == "grace") {
        return [_0x7DF4["next"] ? isNeedLink(_0x7DC3, _0x7DF4["next"]["istart"]) : false, _0x7DF4["next"]]
    };
    var _0x92A0 = false,
        _0x7867 = null;
    for (var _0x92D1 = _0x7DF4["next"]; _0x92D1; _0x92D1 = _0x92D1["next"]) {
        if (_0x92D1["type"] != 4 && _0x92D1["type"] != 11 && _0x92D1["type"] != 5) {
            _0x92A0 = isNeedLink(_0x7DC3, _0x92D1["istart"], true, _0x7DF4["ctype1"] == "chord");
            _0x7867 = _0x92D1;
            break
        }
    };
    return [_0x92A0, _0x7867]
}

function isNeedLink(_0x7DC3, _0x6DAF, _0xB514, _0x825B) {
    var _0xB576 = _0x7DC3["slice"](0, _0x6DAF + 1);
    if (_0xB514) {
        _0xB576 = _0xB576["replace"](/\{\/?([\^\_]?[a-zA-Z][\'\,\/]*)*\}/g, "")
    };
    if (_0x825B) {
        _0xB576 = _0xB576["replace"](/\[.*\]/g, "x")
    };
    _0xB576 = _0xB576["replace"](/\{.([^\{])*\}/g, "");
    _0xB576 = _0xB576["replace"](/\!.([^\!])*\!/g, "");
    _0xB576 = _0xB576["replace"](/(![a-zA-Z0-9\>\<\)\(\.]*!)|\[[a-zA-Z]*\s*:(\s|[a-zA-Z])*\]|("[^\"]*")|u|v|P|y|\.|\(\d*|\)|{|}|\d|\-|\/|\'|,/g, "");
    var _0xB545 = _0xB576["slice"](_0xB576["length"] - 2, _0xB576["length"] - 1);
    if (_0xB545["replace"](/[\s*\:\|\]]/g, "")) {
        return true
    };
    return false
}

function CheckBeamIns() {}
CheckBeamIns["prototype"] = {
    beatTime: 0,
    beatTimeCount: 0,
    curS: null,
    abcString: null,
    lastNoteDot: false,
    lastNoteNflags: 0,
    currMeter: null,
    isComplex: false,
    init: function(_0x7DC3, _0x7DF4) {
        this["abcString"] = _0x7DC3;
        this["curS"] = _0x7DF4
    },
    minBeatTime: 0,
    currComplexArrPoint: 0,
    complexForm: {
        6: [3, 3],
        7: [3, 2, 2],
        9: [3, 3, 3],
        12: [3, 3, 3, 3],
        16: [3, 3, 3, 3, 2, 2]
    },
    currComplexArr: null,
    setBeatTime: function() {
        if (!this["beatTime"]) {
            var _0x7E25 = getMeter(this["curS"]["p_v"]["meter"]["a_meter"][0]);
            if (_0x7E25["bot"] < 4) {
                _0x7E25["bot"] = 4;
                _0x7E25["top"] = (4 / _0x7E25["bot"]) * _0x7E25["top"]
            };
            this["currMeter"] = _0x7E25;
            var _0x6C58 = getTag(this["abcString"], "L");
            if (!_0x6C58) {
                this["beatTime"] = this["curS"]["p_v"]["ulen"]
            } else {
                var _0x7E56 = _0x6C58["replace"](/L:\s*/g, "");
                this["beatTime"] = this["minBeatTime"] = eval("1/" + _0x7E25["bot"]) / eval(_0x7E56) * this["curS"]["p_v"]["ulen"];
                if (8 == _0x7E25["bot"] && _0x7E25["top"] > 5) {
                    this["isComplex"] = true;
                    this["currComplexArr"] = this["complexForm"][_0x7E25["top"]];
                    this["computBeatTime2point"](0)
                } else {
                    this["isComplex"] = false
                }
            }
        }
    },
    computBeatTime2point: function(_0x736D) {
        if (!this["isComplex"]) {
            return
        };
        if (_0x736D == 0) {
            this["currComplexArrPoint"] = 0
        } else {
            this["currComplexArrPoint"]++
        };
        this["beatTime"] = this["minBeatTime"] * this["currComplexArr"][this["currComplexArrPoint"]]
    },
    retBeatBeam: function() {
        var _0x7DF4 = this["curS"];
        if (_0x7DF4["grace"]) {
            return [!_0x7DF4["gr_end"], !_0x7DF4["gr_end"] ? _0x7DF4["next"] : null]
        };
        if (eq("chord", _0x7DF4["ctype"])) {
            return [false, null]
        };
        this["setBeatTime"]();
        var _0x7E87 = [],
            _0x7EE9 = this;
        for (var _0x7867 = _0x7DF4["next"]; _0x7867; _0x7867 = _0x7867["next"]) {
            if (!_0x7867 || _0x7867["type"] == 0) {
                _0x7EE9["clean"]();
                _0x7EE9["lastNoteDot"] = false;
                _0x7EE9["computBeatTime2point"](0);
                _0x7E87 = [false, null];
                break
            };
            if (!eq("8,10", _0x7867["type"])) {
                continue
            };
            if (!_0x7EE9["isComplex"] && _0x7DF4["nflags"] <= 0 && _0x7DF4["dots"] == 0) {
                _0x7E87 = [false, null];
                break
            };
            if (_0x7DF4["nflags"] < 0 && _0x7DF4["dots"] > 0) {
                _0x7E87 = [false, null];
                break
            };
            _0x7EE9["beatTimeCount"] += _0x7DF4["dur"];
            if (_0x7EE9["isComplex"]) {
                if (_0x7EE9["beatTimeCount"] < _0x7EE9["beatTime"]) {
                    _0x7E87 = [true, _0x7867]
                } else {
                    _0x7EE9["clean"]();
                    _0x7EE9["lastNoteDot"] = false;
                    _0x7E87 = [false, null];
                    _0x7EE9["computBeatTime2point"](1)
                };
                break
            } else {
                if (_0x7DF4["dots"] > 0) {
                    _0x7EE9["lastNoteDot"] = true;
                    var _0x7EB8 = 0;
                    switch (_0x7EE9["currMeter"]["bot"]) {
                        case 4:
                            ;
                        case 2:
                            _0x7EB8 = 0;
                            break;
                        default:
                            _0x7EB8 = _0x7DF4["nflags"] - 1;
                            break
                    };
                    _0x7EE9["lastNoteNflags"] = _0x7EB8
                };
                if ((_0x7EE9["lastNoteDot"] && _0x7EE9["beatTimeCount"] < (2 * Number(_0x7EE9["beatTime"]) * Math["pow"](0.5, _0x7EE9["lastNoteNflags"]))) || _0x7EE9["beatTimeCount"] < _0x7EE9["beatTime"]) {
                    _0x7E87 = [true, _0x7867];
                    break
                } else {
                    _0x7EE9["clean"]();
                    _0x7EE9["lastNoteDot"] = false;
                    _0x7E87 = [false, null];
                    break
                }
            }
        };
        return _0x7E87
    },
    clean: function() {
        this["beatTimeCount"] = 0
    },
    refreshBeat: function() {
        this["beatTime"] = 0;
        this["beatTimeCount"] = 0;
        this["currComplexArrPoint"] = 0
    }
};
var chordHei = (circleSpace * 1 + 1 + underlineSpace * 1 + 1 + Number(chordFontSize - 8) - circleMarginTop + chordSpace) * chordScale;
var lastTil = {
    pit: 0,
    istart: 0,
    index: 0,
    isTil: 0
};
var lastLineNum = -1;
var showSplNumber = function(_0x6E73, _0x6DAF, _0x6DE0, _0x6F06, _0x6F37, _0x6ED5, _0x6CEB, _0x6D7E) {
    if (_0x6D7E["dot_low"] || _0x6E73 == "notePic") {
        return
    };
    if (_0x6D7E["a_pic"]) {
        var _0x86C2 = _0x6D7E["a_pic"]["find"](function(_0x89A1) {
            return _0x89A1 && _0x89A1["is_bar_pic"] == 1
        });
        if (_0x86C2) {
            var _0x8660 = 0,
                _0x8691 = 0;
            var _0x88AC = abc["clone"](_0x6D7E["next"]);
            for (var _0x8071 = _0x88AC; _0x8071; _0x8071 = _0x8071["next"]) {
                if (0 == _0x8071["type"]) {
                    _0x8660 = _0x8071["x"] - (_0x6D7E["prev"] && _0x6D7E["prev"]["type"] == 0 ? _0x6D7E["prev"]["x"] : (_0x6D7E["x"] - 5));
                    break
                }
            };
            _0x8691 = _0x6D7E["prev"] && _0x6D7E["prev"]["type"] == 0 ? _0x6D7E["prev"]["x"] : (_0x6D7E["x"] - 5);
            var _0x80D3 = abc["get_svg"]();
            abc["set_svg"](_0x80D3["replaceAll"](_0x86C2["istart"] + "_w", _0x8660)["replaceAll"](_0x86C2["istart"] + "_x", abc["sx"](_0x8691)))
        }
    };
    if (_0x6D7E["a_stk"] && _0x6D7E["a_stk"] && _0x6D7E["a_stk"][0]["t_gr_arr"]) {
        var _0x80D3 = abc["get_svg"]();
        for (var _0x822A in _0x6D7E["a_stk"][0]["t_gr_arr"]) {
            _0x80D3 = _0x80D3["replace"](new RegExp("(<text .*" + _0x822A + "_grace\".*>)(.*)(</text>)", "g"), function() {
                if (_0x6D7E["a_stk"][0]["t_gr_arr"][_0x822A]) {
                    return arguments[1] + _0x6D7E["a_stk"][0]["t_gr_arr"][_0x822A] + arguments[3]
                }
            })
        };
        abc["set_svg"](_0x80D3)
    };
    if (musicType == 0) {
        return
    };
    if (_0x6D7E["type"] == 8 && _0x6D7E["notes"][0]["ti1"]) {
        lastTil["pit"] = _0x6D7E["notes"][0]["pit"];
        lastTil["istart"] = _0x6D7E["istart"];
        lastTil["isTil"] = 1
    };
    var _0x8786 = _0x6D7E["st"];
    var _0x7DF4 = _0x6D7E;
    var _0x8724 = 0;
    var _0x7216 = abc["tgls"];
    var _0x80A2 = (abc["get_staff_tb"]())[_0x8786];
    var _0x8104 = (abc["get_voice_tb"]())[_0x8786];
    var _0x7DC3 = document["getElementById"]("source")["value"];
    var _0x6FFB = _0x7DC3["slice"](_0x6DAF, _0x6DE0);
    var _0x887B = 0,
        _0x884A = 0;
    var _0x83E3 = 0;
    var _0x859C = {};
    _0x7DF4["ctype"] = _0x6E73;
    var _0x792B = {
        highpos: 0,
        lowpos: 0,
        tailPos: 0,
        curPos: 0,
        curnote: null,
        stop: _0x6DE0,
        start: _0x6DAF,
        x: _0x6F06
    };
    beamIns["init"](_0x7DC3, _0x7DF4);
    drawIns["init"](_0x7DF4);
    abc["setCurS"](_0x6D7E);
    if (eq("meter", _0x6E73) && _0x6D7E["time"] == 0 && (!abc["cfmt"]()["showmeterinstaff"] && _0x6D7E["a_meter"]["length"] == 0)) {
        lastKeyMap[_0x8786] = getToneMark(_0x7DC3, _0x8104["key"]);
        beamIns["refreshBeat"]();
        lastTil = {
            pit: 0,
            istart: 0,
            index: 0,
            isTil: 0
        };
        return
    };
    if (eq("tempo", _0x6E73) && !hasTempo) {
        var _0x86F3 = document["getElementById"]("source")["value"]["slice"](_0x6D7E["istart"], _0x6D7E["iend"]);
        if (_0x86F3["indexOf"]("[") == -1) {
            _0x6F37 += -abc["sh"](12);
            if (document["getElementById"]("source")["value"]["indexOf"]("%%text") == -1) {
                _0x6F37 += tempoMgB
            };
            var _0x87B7 = getStaffInfo("source");
            if (_0x87B7["isRhythmStaff"]) {
                abc["cfmt"]()["hiddenkey"] = true
            };
            if (!abc["cfmt"]()["hiddenkey"]) {
                // _0x8724 = drawIns["drawSplMode"](_0x8724, splSy(_0x6F37), getToneMark(_0x7DC3))
                _0x8724 = drawIns["drawSplMode"](_0x8724+18, splSy(_0x6F37), getToneMark(_0x7DC3))
            };
            if (!abc["cfmt"]()["hiddenmeter"]) {
                if (abc["cfmt"]()["hiddenkey"]) {
                    _0x8724 += 55
                };
                var _0x82EE = 0;
                for (var _0x6D1C = 0; _0x6D1C < _0x6D7E["p_v"]["meter"]["a_meter"]["length"]; _0x6D1C++) {
                    drawIns["drawSplMeter"](_0x6D7E["p_v"]["meter"]["a_meter"][_0x6D1C], _0x8724 + _0x82EE, splSy(_0x6F37), 0.75, 15, 42, _0x6D7E["p_v"]["meter"]["istart"]);
                    _0x82EE += 15
                }
            };
            if (eq("meter", _0x6E73) && _0x6D7E["time"] == 0 && !abc["cfmt"]()["showmeterinstaff"]) {
                return
            }
        }
    };
    if (!getSplnumscore(_0x7DC3, _0x8786)) {
        return
    };
    var _0x8381 = undefined;
    if ("bar" == _0x6E73) {
        _0x8381 = _0x6D7E["my_line"]
    };
    if (musicType == 2) {
        _0x887B = _0x80A2["y"] + _0x80A2["topbar"] * _0x80A2["staffscale"];
        if (isChordScore) {
            if (_0x6D7E["multi"] == -1 && _0x6D7E["prev"] && _0x6D7E["prev"]["dot_low_prev_note"]) {
                _0x859C = getNoteY(_0x6D7E["prev"]["dot_low_prev_note"]["istart"], _0x8786, _0x8381)
            } else {
                _0x859C = getNoteY(_0x6DAF, _0x8786, _0x8381)
            };
            _0x887B -= (Number(_0x859C["crdHei"]) + Number(_0x859C["addHei"]))
        };
        _0x83E3 = abc["sh"](splMarginTop)
    } else {
        if (_0x6D7E["multi"] == -1 && _0x6D7E["prev"] && _0x6D7E["prev"]["dot_low_prev_note"]) {
            _0x859C = getNoteY(_0x6D7E["prev"]["dot_low_prev_note"]["istart"], _0x8786, _0x8381)
        } else {
            _0x859C = getNoteY(_0x6DAF, _0x8786, _0x8381)
        };
        _0x887B = _0x80A2["y"] + Number(_0x859C["ymn"]);
        _0x83E3 = abc["sh"](spllineMarginTop)
    };
    transY_tmp = _0x887B;
    _0x83E3 = _0x83E3 - 10;
    if (eq("note,grace,rest", _0x6E73)) {
        abc["set_font"]("spl");
        var _0x6E11 = _0x792B["sw"] = abc["setStrwh"]("0");
        var _0x85CD = _0x83E3,
            _0x887B = splSy(_0x887B),
            _0x8040;
        _0x792B["curPos"] = _0x85CD;
        if (musicType == 2 && eq("grace", _0x6E73)) {
            _0x887B = _0x887B - abc["sh"](10)
        };
        var _0x7F7C = 0,
            _0x7FAD = 0;
        var _0x825B = eq("\\[,\\]", _0x6FFB),
            _0x7FDE = 0;
        var _0x84D8 = []["concat"](_0x6FFB["match"](/[\=\^\_]*[a-zA-Z][\'\,\/]*/g));
        if (_0x825B) {
            _0x7FDE = _0x884A;
            _0x84D8["sort"](function(_0x7526, _0x8A03) {
                var _0x89D2 = _0x7526["replace"](/\_|=|\^|\/|[1-9]/g, "");
                var _0x8A34 = _0x8A03["replace"](/\_|=|\^|\/|[1-9]/g, "");
                return notesArr["indexOf"](_0x89D2) - notesArr["indexOf"](_0x8A34)
            })
        };
        var _0x8445 = [],
            _0x7F4B, _0x7F1A = 0;
        if (_0x84D8 && _0x84D8["length"]) {
            for (var _0x736D = 0, _0x85FE; _0x736D < _0x84D8["length"]; _0x736D++) {
                _0x85FE = {
                    note: _0x84D8[_0x736D],
                    s: _0x6D7E,
                    v: _0x6D7E["v"]
                };
                _0x7F4B = _0x85FE["v"];
                if (_0x825B) {
                    _0x85FE["v"] = _0x85FE["v"] - _0x736D
                };
                if (_0x85FE["v"] < 0) {
                    _0x85FE["v"] = 0
                };
                if (_0x7F4B > _0x85FE["v"]) {
                    _0x7F4B = _0x85FE["v"]
                };
                if (_0x7F1A < _0x85FE["v"]) {
                    _0x7F1A = _0x85FE["v"]
                };
                _0x8445["push"](_0x85FE)
            };
            for (var _0x6D1C = 0; _0x6D1C < _0x8445["length"]; _0x6D1C++) {
                _0x8445[_0x6D1C]["v"] = _0x7F4B + (_0x8445["length"] - 1 - _0x6D1C);
                if (_0x7F1A < _0x8445[_0x6D1C]["v"]) {
                    _0x7F1A = _0x8445[_0x6D1C]["v"]
                };
                if (_0x7F4B > _0x8445[_0x6D1C]["v"]) {
                    _0x7F4B = _0x8445[_0x6D1C]["v"]
                }
            }
        };
        if (_0x6D7E["dot_low_note"] && _0x84D8) {
            if (_0x84D8["indexOf"]("z") > -1) {
                _0x84D8["splice"](_0x84D8["indexOf"]("z"), 1)
            };
            var _0x8197, _0x83B2, _0x8166 = null,
                _0x8819 = [];
            for (_0x8166 = _0x6D7E["dot_low_note"]; _0x8166; _0x8166 = _0x8166["s"]["dot_low_note"]) {
                _0x8197 = _0x7DC3["slice"](_0x8166["istart"], _0x8166["iend"]);
                if (!_0x8197) {
                    continue
                };
                _0x83B2 = _0x8197["match"](/[\=\^\_]*[a-zA-Z][\'\,\/]*/g);
                _0x83B2["sort"](function(_0x7526, _0x8A03) {
                    var _0x89D2 = _0x7526["replace"](/\_|=|\^|\/|[1-9]/g, "");
                    var _0x8A34 = _0x8A03["replace"](/\_|=|\^|\/|[1-9]/g, "");
                    return notesArr["indexOf"](_0x89D2) - notesArr["indexOf"](_0x8A34)
                });
                if (null != _0x83B2 && _0x83B2["length"] == 1) {
                    _0x8445 = _0x8445["concat"]({
                        note: _0x83B2[0],
                        s: _0x8166["s"],
                        v: _0x8166["s"]["v"]
                    })
                } else {
                    _0x825B = true;
                    for (var _0x736D = 0, _0x85FE; _0x736D < _0x83B2["length"]; _0x736D++) {
                        _0x85FE = {
                            note: _0x83B2[_0x736D],
                            s: _0x8166["s"],
                            v: _0x8166["s"]["v"]
                        };
                        _0x8819["push"](_0x85FE)
                    };
                    _0x8445 = _0x8819["concat"](_0x8445)
                }
            };
            if (_0x8445 && _0x8445["length"] && _0x825B) {
                _0x8445["sort"](function(_0x7526, _0x8A03) {
                    var _0x89D2 = _0x7526["note"]["replace"](/\_|=|\^|\/|[1-9]/g, "");
                    var _0x8A34 = _0x7526["note"]["replace"](/\_|=|\^|\/|[1-9]/g, "");
                    return notesArr["indexOf"](_0x89D2) - notesArr["indexOf"](_0x8A34)
                });
                for (var _0x6D1C = 0; _0x6D1C < _0x8445["length"]; _0x6D1C++) {
                    _0x8445[_0x6D1C]["v"] = _0x7F4B + (_0x8445["length"] - 1 - _0x6D1C);
                    if (_0x7F1A < _0x8445[_0x6D1C]["v"]) {
                        _0x7F1A = _0x8445[_0x6D1C]["v"]
                    };
                    if (_0x7F4B > _0x8445[_0x6D1C]["v"]) {
                        _0x7F4B = _0x8445[_0x6D1C]["v"]
                    }
                }
            }
        };
        if (isVoiceMerge) {
            _0x8445["sort"](function(_0x7526, _0x8A03) {
                return _0x7526["v"] - _0x8A03["v"]
            });
            var _0x88DD = getVoiceNumByCurrBar(_0x6DAF, _0x6D7E["v"]);
            if (-1 == _0x88DD) {
                _0x88DD = {
                    vMax: 0,
                    vMin: 0
                }
            };
            var _0x893F = _0x88DD["vMin"];
            if (_0x825B) {
                _0x893F = _0x7F4B
            };
            var _0x890E = _0x88DD["vMax"];
            if (_0x825B) {
                _0x890E = _0x7F1A
            };
            var _0x8476 = {};
            if (_0x8445 && _0x8445["length"]) {
                for (var _0x82BD = 0, _0x828C; _0x82BD < _0x8445["length"]; _0x82BD++) {
                    _0x828C = _0x8445[_0x82BD]["v"] - _0x893F;
                    if (_0x828C > _0x890E) {
                        _0x828C = _0x890E
                    };
                    if (_0x828C < 0) {
                        _0x828C = 0
                    };
                    _0x8445[_0x82BD]["v"] = _0x828C;
                    _0x8476[_0x828C] = _0x8445[_0x82BD]
                }
            };
            var _0x87E8 = [];
            for (var _0x6D1C = 0; _0x6D1C <= _0x890E - _0x893F; _0x6D1C++) {
                _0x87E8["push"](_0x8476[_0x6D1C] || {
                    note: null,
                    v: _0x6D1C
                })
            };
            _0x8445 = _0x87E8;
            _0x8445["sort"](function(_0x7526, _0x8A03) {
                return _0x8A03["v"] - _0x7526["v"]
            })
        } else {
            if (_0x8445) {
                _0x8445["sort"](function(_0x7526, _0x8A03) {
                    var _0x89D2 = _0x7526["note"]["replace"](/\_|=|\^|\/|[1-9]/g, "");
                    var _0x8A34 = _0x8A03["note"]["replace"](/\_|=|\^|\/|[1-9]/g, "");
                    return notesArr["indexOf"](_0x89D2) - notesArr["indexOf"](_0x8A34)
                })
            }
        };
        drawParam["chordLink"] = true;
        if (_0x7DF4["pos"]["spl"] == 9 && _0x7DF4["notes"]["length"] == 1 && transYOffset == 0 && lastLineNum != _0x7DF4["my_line"]) {
            transYOffset = parseFloat(splBarHeight) / 2 + 7.5 * scale;
            lastLineNum = _0x7DF4["my_line"]
        };
        if (_0x7DF4["pos"]["spl"] == 9) {
            abc["out_svg"]("<g type=\"bar_datas\" st=\"" + _0x7DF4["st"] + "\" transform=\"translate(" + _0x884A + "," + (parseFloat(_0x887B["toFixed"](2)) - transYOffset / 2) + ") ")
        } else {
            abc["out_svg"]("<g type=\"bar_datas\" st=\"" + _0x7DF4["st"] + "\" transform=\"translate(" + _0x884A + "," + _0x887B["toFixed"](2) + ") ")
        };
        abc["out_svg"]((eq("grace", _0x6E73) ? "scale(" + graceScale + ")" : ""));
        abc["out_svg"]("\"");
        abc["out_svg"]((eq("grace", _0x6E73) ? " isgrace=\"1\" " : ""));
        abc["out_svg"](">");
        var _0x8414 = (_0x8445 || "")["length"];
        if (_0x7DF4["nflags"] == -2) {
            _0x792B["x"] -= _0x7DF4["wl"] / 2
        };
        var _0x81F9 = 0;
        if (!_0x8445) {
            var _0x84A7 = _0x8445["find"](function(_0x89A1) {
                return _0x89A1["note"] != null
            });
            if (_0x84A7) {
                _0x81F9 = _0x84A7["s"]["wl"]
            }
        };
        for (var _0x6D1C = 0; _0x6D1C <= _0x8414; _0x6D1C++) {
            if (!_0x8445 || !_0x8445[_0x6D1C]) {
                break
            };
            if (_0x8445[_0x6D1C]["note"]) {
                _0x792B["curnote"] = _0x6FFB = _0x8445[_0x6D1C]["note"];
                feCurs = _0x8445[_0x6D1C]["s"];
                if (isVoiceMerge) {
                    feCurs["wl"] = _0x81F9
                };
                drawParam["noteHeight"] = 0;
                _0x8040 = _0x792B["simpleNum"] = getSplnum2note(_0x6FFB, _0x6E73, _0x8104, _0x7DC3, _0x6D7E);
                if (_0x825B) {
                    if (_0x6D1C == 0) {
                        feCurs["ctype"] = _0x6E73 = "note"
                    } else {
                        feCurs["ctype"] = _0x6E73 = "chord"
                    };
                    feCurs["ctype"] = "chord";
                    feCurs["ctype1"] = "chord"
                };
                _0x792B["type"] = feCurs["ctype"];
                if (eq("chord", _0x6E73)) {};
                if (isVoiceMerge && feCurs["dot_low"]) {
                    feCurs["curPos"] = _0x792B["curPos"]
                };
                if (!eq("rest", _0x6E73)) {
                    drawIns["drawSharpSign"](_0x8040, translateValue(_0x6E73, (getNoteStartX(_0x792B["x"], feCurs["wl"]) - abc["sh"](_0x6E11[0]) * 0.5)), _0x792B["curPos"] + Number(_0x6E11[1]) * 0.5)
                };
                var _0x8509 = _0x7DC3["substring"](feCurs["istart"], feCurs["iend"]);
                if (!(eq("rest", _0x6E73) && feCurs["nflags"] == -2) || (_0x8509["indexOf"]("z") < 0)) {
                    var _0x8755 = getNoteStartX(_0x792B["x"], feCurs["wl"]) - 2;
                    var _0x8970 = 0;
                    if (feCurs["dur"] && feCurs["dur"] == 1536 && abc["cfmt"]()["equalbars"]) {
                        _0x8755 = _0x8755 + 2;
                        _0x8970 += 2;
                        if (feCurs["my_line"] != 0 && _0x6D7E["x"] < 60) {
                            _0x8755 = _0x8755 + 4;
                            _0x8970 += 4
                        };
                        _0x792B["splx"] = _0x8755
                    };
                    if (feCurs["slur2s"]) {
                        spl_slur_out(translateValue(_0x6E73, getNoteStartX(_0x792B["x"], feCurs["wl"]) - 4) + 4, _0x792B["curPos"] - 1, translateValue(_0x6E73, getNoteStartX(feCurs["slur2s"]["x"], feCurs["wl"]) - 4) + 4, _0x792B["curPos"] - 1, 1, feCurs["slur2s"]["istart"] - feCurs["istart"] > 10 ? feCurs["slur2sh"] : 10, _0x6D7E["slur_type"], true)
                    };
                    var _0x853A = "";
                    if (/z|x/ ["test"](_0x6FFB)) {
                        _0x853A = /z/ ["test"](_0x6FFB) ? "0" : ""
                    } else {
                        _0x853A = getNumber(_0x8040)
                    };
                    var _0x856B = "";
                    if (_0x7DF4["a_gch"]) {
                        _0x856B = getNoteSplText(_0x7DF4)
                    };
                    if (_0x856B != "" && _0x856B) {
                        drawIns["drawNote"](_0x856B, _0x8755, _0x792B["curPos"] + Number(_0x6E11[1]), null, _0x6D1C)
                    } else {
                        drawIns["drawNote"](_0x853A, _0x8755, _0x792B["curPos"] + Number(_0x6E11[1]), null, _0x6D1C)
                    };
                    drawIns["drawRect"](translateValue(_0x6E73, getNoteStartX(_0x792B["x"], feCurs["wl"]) - 4) + _0x8970, _0x792B["curPos"], abc["sh"](_0x6E11[0] + 4), abc["sh"](_0x6E11[1] + 4), lastTil["pit"] == feCurs["notes"][0]["pit"] && lastTil["isTil"] ? lastTil["istart"] : feCurs["istart"], _0x6D1C, null, null, null, (_0x853A || "x_border"))
                };
                var _0x74F5 = getNumber(_0x8040);
                var _0x81C8 = (eq("0,2,3,4,5,6", _0x74F5) ? (_0x6F06 + abc["sh"](dotMarginRight)) : _0x6F06);
                if (feCurs["a_stk"]) {
                    _0x81C8 += 5
                };
                drawIns["drawDot"](translateValue(_0x6E73, _0x81C8), _0x792B["curPos"] + Number(_0x6E11[1]), _0x6E11[0]);
                var _0x862F = {
                    splnum: _0x792B,
                    curS: feCurs,
                    voicetb: _0x8104,
                    abcString: _0x7DC3,
                    chordindex: _0x6D1C
                };
                drawNoteLen(_0x862F);
                if (eq("note,grace,chord", _0x6E73) && !isRhythm(feCurs) && !(eq("140,141", feCurs["p_v"]["instr"]))) {
                    drawPitch(_0x792B, feCurs)
                };
                if (_0x8414 - 1 == _0x6D1C) {
                    drawIns["drawDeco"](_0x6F06 + Number(_0x6D7E["wl"] || 2), _0x792B["curPos"] + _0x792B["highpos"] - abc["sh"](circleSpace), _0x792B);
                    drawIns["drawGch"](_0x6F06 + Number(_0x6D7E["wl"] || 2), _0x792B["curPos"] + _0x792B["highpos"] - abc["sh"](circleSpace) - (_0x792B["decoPos"] || 0), _0x792B)
                }
            };
            if (_0x6D1C == 0) {
                _0x792B["curPos"] += chordSpace - 3
            };
            if (musicType == 2) {};
            _0x792B["curPos"] += -chordHei;
            if (eq("chord", _0x6E73)) {}
        };
        abc["out_svg"]("</g>");
        if (_0x6D7E["type"] == 8 && !_0x6D7E["notes"][0]["ti1"]) {
            lastTil["pit"] = _0x6D7E["notes"][0]["pit"];
            lastTil["istart"] = _0x6D7E["istart"];
            lastTil["index"] = 0;
            lastTil["isTil"] = 0
        };
        return
    };
    var _0x831F = splSx(_0x6F06) + Number(_0x6ED5["toFixed"](2)) / 2,
        _0x8350 = 0;
    if (musicType == 1) {
        _0x8350 = _0x83E3
    };
    if (musicType == 2 && _0x7DC3["indexOf"]("measurenb 1") > -1 && _0x6D7E["st"] == 0) {
        if (eq("clef", _0x6E73) && _0x6D7E["my_line"] > 0) {
            if (lastBarNumMap[_0x6D7E["my_line"] - 1]) {
                drawIns["drawBarnum"](_0x6D7E["next"]["x"] - Number(_0x6D7E["next"]["wl"] || 2) - 12, splSy(_0x887B) + _0x8350 - 2, lastBarNumMap[_0x6D7E["my_line"] - 1])
            };
            return
        }
    };
    if (_0x8104["key"] && !lastKeyMap[_0x8786]) {
        lastKeyMap[_0x8786] = getToneMark(_0x7DC3, _0x8104["key"])
    };
    if (eq("key", _0x6E73) && eq("\\[", _0x6FFB)) {
        if (eq("bass,treble,alto,tenor", _0x6FFB)) {
            return
        };
        var _0x800F = getToneMark(_0x7DC3, _0x8104["key"]);
        if (_0x800F != lastKeyMap[_0x8786]) {
            var _0x8135 = 5;
            if (_0x6D7E["next"] && _0x6D7E["next"]["a_dd"]) {
                if (_0x6D7E["next"]["a_dd"]["length"] > 0) {
                    a_dd = _0x6D7E["next"]["a_dd"];
                    _0x8135 = 0;
                    for (var _0x6D1C = 0; _0x6D1C < a_dd["length"]; _0x6D1C++) {
                        _0x8135 += a_dd[_0x6D1C]["h"]
                    };
                    _0x8135 = _0x8135 * 0.7
                }
            };
            drawIns["drawSplMode"](_0x6F06, splSy(_0x887B) + _0x8350 - abc["sh"](_0x8135), getToneMark(_0x7DC3, _0x8104["key"]), true, 0.75);
            lastKeyMap[_0x8786] = _0x800F;
            _0x6D7E["splnum_trans_key"] = true
        };
        return
    };
    if ((eq("meter", _0x6E73) && eq("\\[", _0x6FFB) && _0x6D7E["time"] != 0) || (eq("meter", _0x6E73) && _0x6D7E["time"] == 0 && abc["cfmt"]()["showmeterinstaff"])) {
        drawIns["drawSplMeter"](_0x6D7E["p_v"]["meter"]["a_meter"][0], _0x6F06 + _0x7DF4["x_meter"][0] + 3, splSy(_0x887B) + _0x83E3 + abc["sh"](20), 0, _0x6ED5, _0x6CEB);
        beamIns["refreshBeat"]();
        return
    };
    if (eq("bar", _0x6E73)) {
        drawIns["drawDeco"](_0x6F06 + Number(_0x6D7E["wl"] || 2), splSy(_0x887B) + _0x8350 - 2);
        drawIns["drawGch"](_0x6F06 + Number(_0x6D7E["wl"] || 2), splSy(_0x887B) + _0x8350 - 2);
        if (musicType == 2 && _0x7DC3["indexOf"]("measurenb 1") > -1) {
            drawIns["drawBarnum"](_0x6F06 + Number(_0x6D7E["wl"] || 2), splSy(_0x887B) + _0x8350 - 2)
        };
        var _0x8414 = 0;
        if (isChordScore) {
            _0x8414 = parseInt(_0x859C["crdHei"] / (chordHei - 4))
        };
        if (isVoiceMerge) {
            _0x8414 = getVoiceNumByCurrBar(_0x6D7E["istart"], _0x6D7E["v"]);
            if (_0x8414 < 0) {
                _0x8414 = 0
            } else {
                _0x8414 = _0x8414["vMax"] - _0x8414["vMin"]
            };
            if (isChordScore) {
                _0x8414 = parseInt(_0x859C["crdHei"] / (chordHei - 4))
            }
        };
        // console.log('drawAllBar:', _0x7DF4["bar_type"], splSy(_0x887B), _0x831F, _0x8350, chordHei * _0x8414, _0x7DF4);
        drawAllBar(_0x7DF4["bar_type"], splSy(_0x887B), _0x831F, _0x8350, chordHei * _0x8414, _0x7DF4);
        beamIns["refreshBeat"]();
        return
    };
    if (eq("clef", _0x6E73)) {
        drawParam = {
            curNoteLineY: 0,
            lastNotehy: 0
        }
    }
};

function clone(_0x9333) {
    if (!_0x9333) {
        return _0x9333
    };
    var _0x6D7E = JSON["stringify"](_0x9333);
    return JSON["parse"](_0x6D7E)
}

function isChordofNearBar(_0x6D7E) {
    var _0x825B = false,
        _0xB4B2 = 0;
    for (prevs = _0x6D7E; prevs; prevs = _0x6D7E["prev"]) {
        if (!prevs["notes"]) {
            continue
        };
        if (prevs["notes"]["length"] > _0xB4B2) {
            _0xB4B2 = prevs["notes"]["length"]
        };
        if (prevs["notes"]["length"] > 1) {}
    }
}
var singleRect = function(_0x6E73, _0x6DAF, _0x6DE0, _0x6F06, _0x6F37, _0x6ED5, _0x6CEB, _0x6D7E, _0x6E11) {};

function splSlur(_0x7183, _0x9B6E, _0x9B3D) {
    var _0x9ADB = {};
    _0x9ADB["x"] = _0x9B6E["x"] + (_0x9B3D["x"] - _0x9B6E["x"]) / 2;
    _0x9ADB["y"] = _0x9B6E["y"] + (_0x9B3D["y"] - _0x9B6E["y"]) / 2 + 10;
    var _0x9AAA = {};
    _0x9AAA["x"] = _0x9B6E["x"] + 10;
    _0x9AAA["y"] = _0x9ADB["y"];
    drawSlur(_0x7183, _0x9B6E, _0x9B3D, _0x9AAA, _0x9ADB)
}

function drawSlur(_0x7183, _0x9B6E, _0x9B3D, _0x9AAA, _0x9ADB) {
    var _0x9B0C = "m" + _0x9B6E["x"] + " " + _0x9B6E["y"] + " q" + _0x9AAA["x"] + " " + _0x9AAA["y"] + " " + _0x9ADB["x"] + " " + _0x9ADB["y"] + " t" + _0x9B3D["x"] + " " + _0x9B3D["y"];
    _0x9B0C += "m" + _0x9B6E["x"] + " " + _0x9B6E["y"] + " q" + _0x9AAA["x"] + " " + (_0x9AAA["y"] + 2) + " " + _0x9ADB["x"] + " " + (_0x9ADB["y"] + 2) + " t" + _0x9B3D["x"] + " " + _0x9B3D["y"];
    abc["out_svg"]("<path istart=\"" + _0x7183 + "\" stroke-width=\"0.2\" stroke=\"black\" fill=\"black\" fill-rule=\"evenodd\" cat=\"decos\" start=\"\" end=\"\" type=\"slur\" class=\"fill\" d=\"" + _0x9B0C + "\"></path>")
}
var spl_slur_out = function(_0x739E, _0x73CF, _0x79BE, _0x79EF, _0x8EFD, _0x9023, _0x8F2E, _0x91AB, _0x9085, _0x9054) {
    var _0x8F5F, _0x8F90, _0x8FC1, _0x8DD7 = 0.3,
        _0x8E08 = 0.45;
    _0x8F90 = _0x79EF - _0x73CF;
    if (_0x8F90 < 0) {
        _0x8F90 = -_0x8F90
    };
    _0x8F5F = _0x79BE - _0x739E;
    if (_0x8F5F > 40 && _0x8F90 / _0x8F5F < 0.7) {
        _0x8DD7 = 0.3 + 0.002 * (_0x8F5F - 40);
        if (_0x8DD7 > 0.7) {
            _0x8DD7 = 0.7
        }
    };
    var _0x831F = 0.5 * (_0x739E + _0x79BE),
        _0x8350 = 0.5 * (_0x73CF + _0x79EF),
        _0x91DC = _0x831F + _0x8DD7 * (_0x739E - _0x831F),
        _0x923E = _0x8350 + _0x8DD7 * (_0x73CF - _0x8350) + _0x9023;
    _0x91DC = _0x739E + _0x8E08 * (_0x91DC - _0x739E);
    _0x923E = _0x73CF + _0x8E08 * (_0x923E - _0x73CF);
    var _0x920D = _0x831F + _0x8DD7 * (_0x79BE - _0x831F),
        _0x926F = _0x8350 + _0x8DD7 * (_0x79EF - _0x8350) + _0x9023;
    _0x920D = _0x79BE + _0x8E08 * (_0x920D - _0x79BE);
    _0x926F = _0x79EF + _0x8E08 * (_0x926F - _0x79EF);
    _0x8F5F = 0.03 * (_0x79BE - _0x739E);
    _0x8F90 = 2 * _0x8EFD;
    _0x8FC1 = 0.2 + 0.001 * (_0x79BE - _0x739E);
    if (_0x8FC1 > 0.6) {
        _0x8FC1 = 0.6
    };
    _0x8FC1 *= _0x8EFD;
    var _0x90E7 = 1;
    var _0x9118 = "";
    var _0x8FF2 = "";
    if (_0x9085) {
        _0x9118 = _0x9085[0]["istart"];
        _0x8FF2 = _0x9085[_0x9085["length"] - 1]["istart"]
    };
    if (!_0x8F2E) {
        abc["out_svg"]("<path istart=\"" + _0x9118 + "\" stroke-width=\"0.2\" stroke=\"black\" cat=\"decos\" start=\"" + _0x9118 + "\" end=\"" + _0x8FF2 + "\" type=\"slur\" class=\"fill\" d=\"M")
    } else {
        abc["out_svg"]("<path istart=\"" + _0x9118 + "\" stroke-width=\"0.2\" stroke=\"black\" cat=\"decos\" start=\"" + _0x9118 + "\" end=\"" + _0x8FF2 + "\" type=\"slur\" class=\"stroke\" stroke-dasharray=\"5,5\" d=\"M")
    };
    var _0x90B6 = 0;
    var _0x9149 = 0;
    if (_0x9085 && _0x9085["length"] > 0) {
        _0x90B6 = getXIndent(_0x9085[0]);
        _0x739E = _0x739E + _0x90B6;
        _0x9149 = getXIndent(_0x9085[_0x9085["length"] - 1]);
        _0x79BE = _0x79BE + _0x9149
    };
    abc["out_svg"](_0x739E + " " + _0x73CF);
    var _0x8E39 = ((_0x73CF - _0x923E) / _0x90E7)["toFixed"](2);
    var _0x917A = _0x91AB && radianHei ? radianHei : 0;
    if (_0x91AB && _0x8E39 > 0) {
        _0x8E39 = -_0x8E39 - _0x917A
    };
    var _0x8E9B = ((_0x73CF - _0x926F) / _0x90E7)["toFixed"](2);
    if (_0x91AB && _0x8E9B > 0) {
        _0x8E9B = -_0x8E9B - _0x917A
    };
    var _0x8E6A = ((_0x79EF + _0x8FC1 - _0x926F - _0x8F90) / _0x90E7)["toFixed"](2);
    if (_0x91AB && _0x8E6A > 0) {
        _0x8E6A = -_0x8E6A - _0x917A
    };
    var _0x8ECC = ((_0x79EF + _0x8FC1 - _0x923E - _0x8F90) / _0x90E7)["toFixed"](2);
    if (_0x91AB && _0x8ECC > 0) {
        _0x8ECC = -_0x8ECC - _0x917A
    };
    abc["out_svg"]("c" + ((_0x91DC - _0x739E) / abc["stv_g"]()["scale"])["toFixed"](1) + " " + ((_0x73CF - _0x923E) / _0x90E7)["toFixed"](1) + " " + ((_0x920D - _0x739E) / abc["stv_g"]()["scale"])["toFixed"](1) + " " + ((_0x73CF - _0x926F) / _0x90E7)["toFixed"](1) + " " + ((_0x79BE - _0x739E) / abc["stv_g"]()["scale"])["toFixed"](1) + " " + ((_0x73CF - _0x79EF) / _0x90E7)["toFixed"](1));
    if (!_0x8F2E) {
        abc["out_svg"]("\x0A\x09v" + (-_0x8FC1)["toFixed"](1) + "c" + ((_0x920D - _0x8F5F - _0x79BE) / abc["stv_g"]()["scale"])["toFixed"](1) + " " + ((_0x79EF + _0x8FC1 - _0x926F - _0x8F90) / _0x90E7)["toFixed"](1) + " " + ((_0x91DC + _0x8F5F - _0x79BE) / abc["stv_g"]()["scale"])["toFixed"](1) + " " + ((_0x79EF + _0x8FC1 - _0x923E - _0x8F90) / _0x90E7)["toFixed"](1) + " " + ((_0x739E - _0x79BE) / abc["stv_g"]()["scale"])["toFixed"](1) + " " + ((_0x79EF + _0x8FC1 - _0x73CF) / _0x90E7)["toFixed"](1))
    };
    abc["out_svg"]("\"/>\x0A")
};

function getDimOrCrescMatch() {
    var _0xABE4 = [];
    for (var _0x7183 in syms) {
        var _0x75EA = syms[_0x7183];
        if (_0x75EA["a_dd"]) {
            var _0x7588 = _0x75EA["a_dd"];
            for (var _0x6D1C = 0; _0x6D1C < _0x7588["length"]; _0x6D1C++) {
                var _0xABB3 = _0x7588[_0x6D1C];
                if (_0xABB3["glyph"] == "dim" || _0xABB3["glyph"] == "cresc") {
                    var _0x9333 = new Object();
                    if (_0xABB3["dd_en"]) {
                        _0x9333["type"] = _0xABB3["glyph"];
                        _0x9333["sIstart"] = _0x75EA["istart"];
                        var _0xA0FB = _0xABB3["name"];
                        var _0xAC15 = _0xA0FB["replace"]("(", ")");
                        for (var _0xAC46 in syms) {
                            var _0xAB82 = syms[_0xAC46];
                            if (_0xAC46 > _0x7183 && _0xAB82["v"] == _0x75EA["v"] && check_deco(_0xAB82, _0xAC15)) {
                                _0x9333["eIstart"] = _0xAB82["istart"];
                                break
                            }
                        };
                        _0xABE4["push"](_0x9333)
                    }
                }
            }
        }
    };
    return _0xABE4
}

function checkNoteInDimOrCresc(_0x6D7E) {
    var _0x9302 = getDimOrCrescMatch();
    for (var _0x6D1C = 0; _0x6D1C < _0x9302["length"]; _0x6D1C++) {
        var _0x9333 = _0x9302[_0x6D1C];
        if (_0x6D7E["istart"] >= _0x9333["sIstart"] && _0x6D7E["istart"] <= _0x9333["eIstart"]) {
            return true
        }
    };
    return false
}

function getNoteSplText(_0x6D7E) {
    var _0x6E42 = getGch(_0x6D7E, "jptext:");
    if (_0x6E42) {
        return _0x6E42["replace"]("jptext:", "")["split"](":")[0]
    };
    return ""
}

function getNoteSplTextMidi(_0x6D7E) {
    var _0x6E42 = getGch(_0x6D7E, "jptext:");
    if (_0x6E42) {
        var _0xAE61 = _0x6E42["replace"]("jptext:", "")["split"](":");
        if (_0xAE61["length"] > 1) {
            return _0xAE61[1]
        }
    };
    return ""
}